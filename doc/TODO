This is the public Owl TODO list.  Its primary purpose is to give you
some ideas of how to contribute to Owl development (but please also
see CONVENTIONS if you do).  It is not intended as a poor replacement
for a request tracking system (although we don't yet use one) and it
is not a complete TODO list either.

Currently, this list is limited to packages.  It doesn't have to be,
so this may change.  In reality, besides the packages, there're quite
a few bits of work on Owl build environment, kernel, documentation,
and the facilities we use to run the project.

If something is listed as ASSIGNED, it doesn't mean you shouldn't
offer to do it.  Re-assigning is perfectly fine if it would seem to
help achieve the goal.  (In fact, I really don't expect some people to
complete what they've volunteered for.)


	apache.

[PRIORITY: low]
Package Russian Apache 1.3.x, but have the use of Cyrillic charsets
disabled by default (use US-ASCII or iso-8859-1).  Use mod_ssl.  Build
modules as DSO, only load the safest subset of them by default.  Make
it fail-close on suEXEC.  Clone and maintain a version of suEXEC more
friendly to virtual hosting.


	automake, libtool.

[PRIORITY: medium]
Deal with temporary file handling.  The RH-derived patch in libtool is
fail-open on mktemp(1).  automake.texi suggests bad practices (look for
"make DESTDIR=/tmp/staging install" and what follows).


	bash.

[PRIORITY: low]
[ASSIGNED: galaxy@]
Update to latest release (we're currently at 2.05, but 2.05b went out
a long time ago), with our patches.  Make sure it still builds cleanly
with -Wall (due to our patches).  Once again try to get our generic
fixes (the "-owl-fixes.diff") to the maintainer (haven't received a
response).


	bind.

[PRIORITY: medium]
[ASSIGNED: galaxy@]
Package BIND 9.x, built without pthreads.  Use the query ID shuffle
code from our glibc.  Allocate and use a pseudo-user, setup and use a
chroot jail.  Ensure the PID file is dealt with safely (it shouldn't
allow for named -> root attacks on BIND itself and on our startup
scripts), preferably have it kept in the system's /var/run and as
root.  (Jarno did some work on this.)


	binutils.

[PRIORITY: medium]
Update to latest release.  In particular, we need the "include"
directive support in /etc/ld.so.conf.


	bison, dialog, diffstat, diffutils, file, hdparm, man-pages.

[PRIORITY: low]
[ASSIGNED: mci@]
Update these to latest releases once in a while.


	cpio, tar.

[PRIORITY: medium]
Audit for and deal with:

1. Races when creating archives: whether it may be made to leave the
intended directory tree by moving directories around, whether it may
be made to block on reading a FIFO or device, -- should probably use
O_NOFOLLOW, then fstat().  Refer to the patches to FTS code in glibc
and to mtree, both of which had similar issues.

2. Races when extracting archives: whether it will be possible for an
attacker to place [sym]links into directories being extracted such
that files in them would go to the wrong place, -- for example, when
restoring user home directories from a backup, as root.  Races between
the calls to chmod() and chown(), -- if chmod() is done first, that
would mean that permissions may be given to the wrong group for a
moment and if chown() is done first it may mean that extra permissions
are given to the file's group for a moment.  The right sequence is
chmod() to a safe mode (0700 & mode), then chown(), then chmod().

3. In cpio only: ways a malicious archive may specify that files go
outside of the intended directory tree.  This has been dealt with in
tar already.


	cvs.

[PRIORITY: medium]
Update to the latest 1.11.x or to 1.12.x.  It is starting to feel like
a waste of time to continue back-porting security fixes to our 1.11.5.


	dhcp.

[PRIORITY: medium]
[ASSIGNED: schmidt@, solar@]
All of the DHCP suite programs should use /dev/urandom as the only
source of randomness.  The resolver should be either corrected to use
unpredictable query IDs, or dropped in favor of the one in glibc.

[PRIORITY: low]
[ASSIGNED: schmidt@, solar@]
The DHCP client should be modified to run as a dedicated pseudo-user
and in a chroot jail.  This requires privilege separation within the
client (not easy).


	fileutils, sh-utils, textutils.

[PRIORITY: medium]
[ASSIGNED: exon@]
Update to coreutils (one package instead of three).

Update DIR_COLORS from dircolors.hin.  In ls, dir, and vdir use
__progname instead of separate binaries with hard-coded ls_mode.

[PRIORITY: low]
The man pages and texinfo documentation for true(1) and false(1) are
wrong for the assembly versions (we do not support any command-line
options).  Update the documentation to match the reality.


	findutils.

[PRIORITY: medium]
Update to 4.2.20+ dropping the -delete patch (a better version of it
has been included upstream).


	gdb.

[PRIORITY: medium]
Investigate and deal with fd leaks into traced programs.

[PRIORITY: low]
[ASSIGNED: solar@]
Package a tool to trap unaligned accesses on Alpha.

[PRIORITY: low]
Update to latest release.


	gettext.

[PRIORITY: low]
Split the appropriate files into a gettext-devel subpackage for Fedora
compatibility.


	glibc.

[PRIORITY: medium]
After upgrading to glibc 2.3.5, patch its __libc_message() to write to
syslog by default (rather than as a fallback) and when doing so to
connect to /dev/log and write there directly, without utilizing
vsyslog(3) (which may use malloc()-family functions and thus is unsafe
to be invoked on a detected malloc inconsistency).

[PRIORITY: low]
Make mkstemp(3) and friends produce unpredictable filenames (not just
unique).

[PRIORITY: low]
Fix locales to not declare characters with codes 0 to 0x1f and 0x7f to
0x9f as printable unless some really have to be.  Do it better than by
patching localedef(1) as we do now.

[PRIORITY: low]
The above problem also applies to wide character versions of the
locales which are not corrected by our current localedef(1) patch.
Either fix the locales or enhance the localedef(1) patch to also apply
to the wide character versions.  The problem is seen in particular
with the koi8-r locale for characters in the range 0x80 to 0x9f when
translated with mbrtowc() and checked with iswcntrl().  We have to
build Mutt without glibc's wide character functions for that reason.

[PRIORITY: low]
Support an /etc/libc.conf for hardening features such as zeroing out
freed memory.

[PRIORITY: low]
Investigate and deal with snprintf(3) looping and crashing with huge
field widths.


	gnupg.

[PRIORITY: medium]
[ASSIGNED: mci@]
Keep it to latest release.


	john.

[PRIORITY: medium]
[ASSIGNED: solar@]
Update documentation and .chr files, release as 1.7.  (Lots of other
items are in a separate non-public TODO list for just John.)


	libnet, libnids, libpcap.

[PRIORITY: low]
[ASSIGNED: nergal@]
Update to latest releases.


	ltrace.

[PRIORITY: medium]
[ASSIGNED: mci@]
Package libelf or elfutils.  Update ltrace to the new version to make
it work again after our binutils update (which has already been made).


	mailx.

[PRIORITY: low]
Sync with current OpenBSD.

If we ever add OpenBSD's lockspool, make sure the order in which mailx
obtains fcntl() and dot-locks is compatible with that of Postfix and
procmail.


	man.

[PRIORITY: low]
Allocate a pseudo-user and group for makewhatis, have makewhatis
results go under a separate directory writable by the group.  Provide
a makewhatis cron job.  Don't process cat (preformatted) pages in
makewhatis.


	mtree.

[PRIORITY: low]
Correct the man page to not refer to chflags(1) (it's a BSD'ism).
Support ext2fs flags.  Optionally don't store and ignore symlink
permissions.  Optionally dereference symlinks.


	mutt.

[PRIORITY: medium]
Extensively test all of the temporary file handling touched by our
patch.  One way to do it is start up mutt under a "strace -fF", then,
reading the patch, make use of every feature the patch touches.  Make
sure that everything works, the temporary files are dealt with safely
(as seen from the strace output), and all of them are removed on exit.

[PRIORITY: low]
[ASSIGNED: jhuuskon@]
Consider enhancements from VVV (http://mutt.org.ua).


	ntp.

[PRIORITY: low]
Package OpenNTPD.  Use UID/GID 185 (already allocated), but rename the
pseudo-user as appropriate (ntpd?).


	openssh.

[PRIORITY: medium]
[ASSIGNED: solar@]
Keep OpenSSH to latest release, with our modifications obviously.

[PRIORITY: low]
Support changing expired passwords for the privsep case as well.
Re-enable forwardings if disabled because of a forced password change.
Do PAM session management as root (again).

[PRIORITY: low]
Investigate and solve the SSH-1 sshd crashes on Alpha w/ BWX (EV56+)
for real rather than workaround them (by building deattack.c without
BWX as is done currently), unless this proves to be a CPU bug (which
it might be).


	openssl.

[PRIORITY: medium]
[ASSIGNED: solar@]
Keep OpenSSL to latest in a branch.


	owl-cdrom.

[PRIORITY: low]
Also provide a silo.conf and generic kernel configuration for SPARC.


	owl-dev.

[PRIORITY: low]
[ASSIGNED: mci@]
Migrate to MAKEDEV-C with proper modifications.


	owl-setup.

[PRIORITY: medium]
Replace with a full-featured installer which would have the ability to
guide through the installation process, including disk partitioning,
filesystem creation, "make installworld" and optionally building and
installing a kernel.  Might move from the current shell & dialog to
C & cdk or even C++ & ndk++ (which would then be packaged).


	owl-startup.

[PRIORITY: low]
Replace all of the RH-derived networking scripts with our own (yet to
be written) or with etcnet:

http://pilot.org.ua/etcnet/

[PRIORITY: low]
Unmount any tmpfs filesystems prior to invoking swapoff.  Otherwise,
on swapoff, any swapped out data on tmpfs is first loaded into memory
which may be taking a long time or may fail or cause other things to
fail if there's insufficient physical memory available.


	pam.

[PRIORITY: medium]
Update to latest release (with our modifications), either Red Hat's
again or official Linux-PAM with its pre-compiled documentation and
still adding a few modules from Red Hat's for compatibility.

[PRIORITY: low]
Add support for "include" directive per ALT Linux's proposal, using
pam-0.77-alt-pam_include.patch.  Make other packages in Owl use it.

[PRIORITY: low]
Move pam_pwdb (with its dependency on libpwdb) into a new pam-compat
subpackage.

[PRIORITY: low]
Review PAM man pages in OpenPAM (FreeBSD-current) and on other OSes,
most likely import some from OpenPAM (with minor changes for Linux-PAM
where it differs) and correct others.  Currently, the Linux-PAM man
pages are in a really bad shape.


	pam_mktemp.

[PRIORITY: low]
Do error logging.


	pam_passwdqc.

[PRIORITY: low]
(Optionally?) only display the requirements for valid passwords once
rather than before each retry (from William R. Knox).

[PRIORITY: low]
Provide some real stacking examples in the documentation.

[PRIORITY: low]
Support an external configuration file where settings common to uses
of the module by several services could reside.  (If we start using
pam_stack or add an equivalent libpam feature, that wouldn't be needed
for Owl itself any longer.)

[PRIORITY: low]
Support external wordlists and "31337" word mangling.


	patch.

[PRIORITY: low]
Solve the DoS-against-itself on the temporary file.


	perl.

[PRIORITY: low]
Double-check the perl packages in Fedora and RHEL and likely bump
Epoch to 2 in our package for compatibility.

[PRIORITY: low]
Re-implement temporary file handling in CGI.pm making use of File::Temp.

[PRIORITY: low]
Fix the tests (or the functions they test) such that "make test" will
no longer use /tmp when $TMPDIR is set.  Currently, with Perl 5.8.3-owl1,
3 of the tests fail when /tmp is unavailable, despite $TMPDIR being set.

[PRIORITY: low]
Determine which of the tests result in network accesses (is it just
DNS lookups?) and disable those from within our perl.spec.


	popa3d, scanlogd.

Separate, currently non-public, TODO lists exist.


	postfix.

[PRIORITY: medium]
Update to latest release, considering a number of patches and add-ons.

[PRIORITY: medium]
Restrict queue views and runs.

[PRIORITY: medium]
Open PAM sessions for programs run from .forward or LDA such that
resource limits are set.

[PRIORITY: low]
The order of fcntl() and dot-locks is currently compatible with
procmail, but not the Debian policy.  Someone should get either the
Debian policy or both Postfix and procmail corrected.

[PRIORITY: low]
Bug: when updating the chroot jail to reflect changes in system
libraries, our patched postfix-script does not know to remove copies
of library versions which are no longer in the system.


	procmail.

[PRIORITY: low]
Update to 3.22+.


	rpm.

[PRIORITY: medium]
[ASSIGNED: galaxy@]
Should remove old files on "-U --force" even if package versions
match.  Right now, when forcibly updating a package to what appears to
be the same version, but the previously installed package contains
files that no longer exist in the package being installed, the files
are not removed from the system and become orphaned.

[PRIORITY: medium]
[ASSIGNED: galaxy@]
Provide a safe default for %_repackage_dir; /var/tmp is not quite it.

[PRIORITY: medium]
[ASSIGNED: galaxy@]
Set umask 022 for install scripts execution.

[PRIORITY: medium]
Audit and correct rpm's temporary file handling and its support for
package signature checking.

[PRIORITY: low]
[ASSIGNED: galaxy@]
Once we have a libelf or elfutils package (for ltrace), make rpm also
use the system's libelf.


	shadow-utils.

[PRIORITY: low]
Try to feed generic patches upstream.  Sync to the latest.


	SimplePAMApps.

[PRIORITY: low]
login should accept IP addresses rather than hostnames such that it
can log both into wtmp.


	strace.

[PRIORITY: low]
Update to 4.5.7+ with ALT's patches.

[PRIORITY: low]
After the above update is complete, re-test pipe(2) reporting on Alpha
and fix it if it's still incorrect.


	sysklogd.

[PRIORITY: medium]
chown to syslogd (group or user if the group permissions are already
in use) in syslogd itself.

[PRIORITY: low]
Protect against timestamp spoofing.

[PRIORITY: low]
In klogd, support new System.map format used starting with recent
2.2.x kernels on Alpha.

[PRIORITY: low]
Migrate to a better alternative for syslogd, retain this package for
klogd.  Most likely go with a clone of Darren Reed's nsyslogd, which
we will likely have to maintain ourselves.


	SysVinit.

[PRIORITY: low]
Keep to latest release.


	telnet.

[PRIORITY: low]
Sync with current OpenBSD.

[PRIORITY: low]
Pass IP addresses to login once it supports that.

[PRIORITY: low]
Re-enable IPv6 in the client once glibc is fixed.


	tcb.

[PRIORITY: low]
Bump syslog priorities of many pam_tcb error messages.


	traceroute.

[PRIORITY: medium]
Replace with Olaf Kirch's.  URLs:
http://rechner.lst.de/~okir/traceroute/
ftp://ftp.lst.de/pub/people/okir/traceroute


	vim.

[PRIORITY: low]
Update to latest 6.1 patchlevel.

[PRIORITY: low]
Use mkdtemp(3) for the directory after the glibc update.


	vixie-cron.

[PRIORITY: medium]
[ASSIGNED: jmbr@, solar@]
Open PAM sessions for cron jobs such that resource limits are set.
This is now implemented in ALT Linux's package, so we need to import
from there.

[PRIORITY: low]
In crontab(1), automatically convert input files from DOS linefeeds
whenever needed.  Alternatively, have crond(8) support crontab files
with DOS linefeeds.  (This is starting to become a frequent problem in
virtual hosting environments.)

[PRIORITY: low]
Reject or support long usernames in crontab(1).


	vsftpd.

[PRIORITY: low]
Keep to latest release.


	xinetd.

[PRIORITY: medium]
Do ident lookups (if enabled) as a dedicated pseudo-user.

[PRIORITY: low]
Develop and migrate to a cleaner replacement, with some limited
configuration file compatibility.

$Id: Owl/doc/TODO,v 1.63 2005/04/26 05:19:47 solar Exp $
