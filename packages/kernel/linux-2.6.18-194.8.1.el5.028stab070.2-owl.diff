diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/Makefile linux-2.6.18-194.8.1.el5.028stab070.2.owl1/Makefile
--- linux-2.6.18-194.8.1.el5.028stab070.2/Makefile	2010-07-08 16:01:53 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/Makefile	2010-07-15 16:02:36 +0000
@@ -1,7 +1,7 @@
 VERSION = 2
 PATCHLEVEL = 6
 SUBLEVEL = 18
-EXTRAVERSION = -194.8.1.el5.028stab070.2
+EXTRAVERSION = -194.8.1.el5.028stab070.2.owl1
 RHEL_MAJOR = 5
 RHEL_MINOR = 5
 NAME=Avast! A bilge rat!
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/arch/i386/kernel/cpu/amd.c linux-2.6.18-194.8.1.el5.028stab070.2.owl1/arch/i386/kernel/cpu/amd.c
--- linux-2.6.18-194.8.1.el5.028stab070.2/arch/i386/kernel/cpu/amd.c	2010-07-08 16:01:49 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/arch/i386/kernel/cpu/amd.c	2010-07-15 11:13:30 +0000
@@ -45,11 +45,14 @@ static void __cpuinit amd_fixup_dcm(stru
 	if (cpu_has(c, X86_FEATURE_AMD_DCM))
 		return;
 
+#if 0
+/* early_is_k8_nb() is only defined under arch/x86_64/ */
 	/* proceed only if there is a valid AMD northbridge
 	 * (not in virtualized environments!)
 	 */
 	if (!early_is_k8_nb(read_pci_config(0, 24, 3, 0x00)))
 		return;
+#endif
 
 	rdmsrl(0xc001100c, value);
 
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/arch/i386/kernel/cpu/intel_cacheinfo.c linux-2.6.18-194.8.1.el5.028stab070.2.owl1/arch/i386/kernel/cpu/intel_cacheinfo.c
--- linux-2.6.18-194.8.1.el5.028stab070.2/arch/i386/kernel/cpu/intel_cacheinfo.c	2010-07-08 16:01:51 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/arch/i386/kernel/cpu/intel_cacheinfo.c	2010-07-15 16:27:01 +0000
@@ -47,10 +47,12 @@ static void wbinvd_on_cpu(int cpu)
 	smp_call_function_single(cpu, __wbinvd, NULL, 0, 1);
 }
 
+#if 0
 static int wbinvd_on_all_cpus(void)
 {
 	return on_each_cpu(__wbinvd, NULL, 0, 1);
 }
+#endif
 
 /* from arch/x86/kernel/cpu/amd.c upstream */
 static int amd_get_nb_id(int cpu)
@@ -331,9 +333,12 @@ amd_check_l3_disable(int index, struct _
 	     (boot_cpu_data.x86_mask  < 0x1)))
 		return;
 
+#if 0
+/* num_k8_northbridges is only defined under arch/x86_64/ */
 	/* not in virtualized environments */
 	if (num_k8_northbridges == 0)
 		return;
+#endif
 
 	this_leaf->can_disable = true;
 	this_leaf->l3_indices  = amd_calc_l3_indices();
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/arch/x86_64/Kconfig linux-2.6.18-194.8.1.el5.028stab070.2.owl1/arch/x86_64/Kconfig
--- linux-2.6.18-194.8.1.el5.028stab070.2/arch/x86_64/Kconfig	2010-07-08 16:01:51 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/arch/x86_64/Kconfig	2010-07-15 11:07:35 +0000
@@ -476,6 +476,7 @@ config IOMMU
 	default y
 	select SWIOTLB
 	select AGP
+	select IOMMU_HELPER
 	depends on PCI && !X86_64_XEN
 	help
 	  Support for full DMA access of devices with 32bit memory access only
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/drivers/char/keyboard.c linux-2.6.18-194.8.1.el5.028stab070.2.owl1/drivers/char/keyboard.c
--- linux-2.6.18-194.8.1.el5.028stab070.2/drivers/char/keyboard.c	2010-07-08 16:01:51 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/drivers/char/keyboard.c	2010-07-15 11:07:35 +0000
@@ -1376,7 +1376,7 @@ int __init kbd_init(void)
 		kbd_table[i].lockstate = KBD_DEFLOCK;
 		kbd_table[i].slockstate = 0;
 		kbd_table[i].modeflags = KBD_DEFMODE;
-		kbd_table[i].kbdmode = VC_UNICODE;
+		kbd_table[i].kbdmode = VC_XLATE;
 	}
 
 	input_register_handler(&kbd_handler);
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/drivers/char/vt.c linux-2.6.18-194.8.1.el5.028stab070.2.owl1/drivers/char/vt.c
--- linux-2.6.18-194.8.1.el5.028stab070.2/drivers/char/vt.c	2010-07-08 16:01:51 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/drivers/char/vt.c	2010-07-15 11:07:35 +0000
@@ -1497,7 +1497,7 @@ static void reset_terminal(struct vc_dat
 	vc->vc_charset		= 0;
 	vc->vc_need_wrap	= 0;
 	vc->vc_report_mouse	= 0;
-	vc->vc_utf		= 1;
+	vc->vc_utf		= 0;
 	vc->vc_utf_count	= 0;
 
 	vc->vc_disp_ctrl	= 0;
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/drivers/parisc/eisa_eeprom.c linux-2.6.18-194.8.1.el5.028stab070.2.owl1/drivers/parisc/eisa_eeprom.c
--- linux-2.6.18-194.8.1.el5.028stab070.2/drivers/parisc/eisa_eeprom.c	2006-09-20 03:42:06 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/drivers/parisc/eisa_eeprom.c	2009-08-10 06:51:35 +0000
@@ -54,7 +54,7 @@ static ssize_t eisa_eeprom_read(struct f
 	ssize_t ret;
 	int i;
 	
-	if (*ppos >= HPEE_MAX_LENGTH)
+	if (*ppos < 0 || *ppos >= HPEE_MAX_LENGTH)
 		return 0;
 	
 	count = *ppos + count < HPEE_MAX_LENGTH ? count : HPEE_MAX_LENGTH - *ppos;
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/fs/Kconfig linux-2.6.18-194.8.1.el5.028stab070.2.owl1/fs/Kconfig
--- linux-2.6.18-194.8.1.el5.028stab070.2/fs/Kconfig	2010-07-08 16:01:52 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/fs/Kconfig	2010-07-15 11:43:05 +0000
@@ -473,6 +473,7 @@ config QFMT_V2
 config SIM_FS
 	tristate "VPS filesystem"
 	depends on VZ_QUOTA
+	select EXPORTFS
 	default m
 	help
 	  This file system is a part of Virtuozzo. It intoduces a fake
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/fs/proc/base.c linux-2.6.18-194.8.1.el5.028stab070.2.owl1/fs/proc/base.c
--- linux-2.6.18-194.8.1.el5.028stab070.2/fs/proc/base.c	2010-07-08 16:01:52 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/fs/proc/base.c	2010-07-15 11:30:25 +0000
@@ -260,10 +260,10 @@ static struct pid_entry tgid_base_stuff[
 	  S_IFREG|S_IRUGO|S_IWUSR),
 #endif
 #ifdef CONFIG_TASK_IO_ACCOUNTING
-	E(PROC_TGID_IO,             "io",  S_IFREG|S_IRUGO),
+	E(PROC_TGID_IO,             "io",  S_IFREG|S_IRUSR),
 #endif
 #ifdef CONFIG_STACKTRACE_PROC
-	E(PROC_TGID_STACK,     "stack",   S_IFREG|S_IRUGO),
+	E(PROC_TGID_STACK,     "stack",   S_IFREG|S_IRUSR),
 #endif
 
 	{0,0,NULL,0}
@@ -310,10 +310,10 @@ static struct pid_entry tid_base_stuff[]
 #endif
 	E(PROC_TID_LIMITS, "limits", S_IFREG|S_IRUSR),
 #ifdef CONFIG_TASK_IO_ACCOUNTING
-	E(PROC_TID_IO,         "io",      S_IFREG|S_IRUGO),
+	E(PROC_TID_IO,         "io",      S_IFREG|S_IRUSR),
 #endif
 #ifdef CONFIG_STACKTRACE_PROC
-	E(PROC_TID_STACK,      "stack",   S_IFREG|S_IRUGO),
+	E(PROC_TID_STACK,      "stack",   S_IFREG|S_IRUSR),
 #endif
 
 	{0,0,NULL,0}
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/include/linux/dmar.h linux-2.6.18-194.8.1.el5.028stab070.2.owl1/include/linux/dmar.h
--- linux-2.6.18-194.8.1.el5.028stab070.2/include/linux/dmar.h	2010-07-08 16:01:47 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/include/linux/dmar.h	2010-07-15 11:07:35 +0000
@@ -125,10 +125,6 @@ extern int irq_remapped(int irq);
 extern struct intel_iommu *map_dev_to_ir(struct pci_dev *dev);
 extern struct intel_iommu *map_ioapic_to_ir(int apic);
 #else
-static inline int enable_drhd_fault_handling(void)
-{
-	return -1;
-}
 static inline int alloc_irte(struct intel_iommu *iommu, int irq, u16 count)
 {
 	return -1;
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/init/do_mounts_md.c linux-2.6.18-194.8.1.el5.028stab070.2.owl1/init/do_mounts_md.c
--- linux-2.6.18-194.8.1.el5.028stab070.2/init/do_mounts_md.c	2006-09-20 03:42:06 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/init/do_mounts_md.c	2007-10-03 03:57:50 +0000
@@ -122,6 +122,7 @@ static void __init md_setup_drive(void)
 
 	for (ent = 0; ent < md_setup_ents ; ent++) {
 		int fd;
+		int disknum = 0;
 		int err = 0;
 		char *devname;
 		mdu_disk_info_t dinfo;
@@ -144,7 +145,7 @@ static void __init md_setup_drive(void)
 
 			p = strchr(devname, ',');
 			if (p)
-				*p++ = 0;
+				*p = 0;
 
 			dev = name_to_dev_t(devname);
 			if (strncmp(devname, "/dev/", 5) == 0)
@@ -154,17 +155,22 @@ static void __init md_setup_drive(void)
 			if (rdev)
 				dev = new_decode_dev(rdev);
 			if (!dev) {
-				printk(KERN_WARNING "md: Unknown device name: %s\n", devname);
-				break;
+				printk(KERN_WARNING "md: Skipping unknown device name: %s\n", devname);
+				if (p)
+					*p++ = ',';
+				devname = p;
+				continue;
 			}
 
-			devices[i] = dev;
+			devices[disknum++] = dev;
 
+			if (p)
+				*p++ = ',';
 			devname = p;
 		}
-		devices[i] = 0;
+		devices[disknum] = 0;
 
-		if (!i)
+		if (!disknum)
 			continue;
 
 		printk(KERN_INFO "md: Loading md%s%d: %s\n",
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/kernel/panic.c linux-2.6.18-194.8.1.el5.028stab070.2.owl1/kernel/panic.c
--- linux-2.6.18-194.8.1.el5.028stab070.2/kernel/panic.c	2010-07-08 16:01:52 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/kernel/panic.c	2010-07-15 11:07:35 +0000
@@ -20,7 +20,7 @@
 #include <linux/kexec.h>
 #include <linux/debug_locks.h>
 
-int panic_on_oops = 1;
+int panic_on_oops;
 int tainted = 1;
 static int pause_on_oops;
 static int pause_on_oops_flag;
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/kernel/printk.c linux-2.6.18-194.8.1.el5.028stab070.2.owl1/kernel/printk.c
--- linux-2.6.18-194.8.1.el5.028stab070.2/kernel/printk.c	2010-07-08 16:01:52 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/kernel/printk.c	2010-07-15 11:07:35 +0000
@@ -249,10 +249,6 @@ int do_syslog(int type, char __user *buf
 	if (!ve_is_super(get_exec_env()) && (type == 6 || type == 7))
 		goto out;
 
-	error = security_syslog(type);
-	if (error)
-		return error;
-
 	switch (type) {
 	case 0:		/* Close log */
 		break;
@@ -384,6 +380,12 @@ out:
 
 asmlinkage long sys_syslog(int type, char __user *buf, int len)
 {
+	int error = 0;
+
+	error = security_syslog(type);
+	if (error)
+		return error;
+		
 	return do_syslog(type, buf, len);
 }
 
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/net/llc/af_llc.c linux-2.6.18-194.8.1.el5.028stab070.2.owl1/net/llc/af_llc.c
--- linux-2.6.18-194.8.1.el5.028stab070.2/net/llc/af_llc.c	2006-09-20 03:42:06 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/net/llc/af_llc.c	2009-08-26 10:16:29 +0000
@@ -155,6 +155,9 @@ static int llc_ui_create(struct socket *
 	struct sock *sk;
 	int rc = -ESOCKTNOSUPPORT;
 
+	if (!capable(CAP_NET_RAW))
+		return -EPERM;
+
 	if (likely(sock->type == SOCK_DGRAM || sock->type == SOCK_STREAM)) {
 		rc = -ENOMEM;
 		sk = llc_sk_alloc(PF_LLC, GFP_KERNEL, &llc_proto);
@@ -911,6 +914,7 @@ static int llc_ui_getname(struct socket 
 	struct llc_sock *llc = llc_sk(sk);
 	int rc = 0;
 
+	memset(&sllc, 0, sizeof(sllc));
 	lock_sock(sk);
 	if (sock_flag(sk, SOCK_ZAPPED))
 		goto out;
diff -urp linux-2.6.18-194.8.1.el5.028stab070.2/scripts/mkcompile_h linux-2.6.18-194.8.1.el5.028stab070.2.owl1/scripts/mkcompile_h
--- linux-2.6.18-194.8.1.el5.028stab070.2/scripts/mkcompile_h	2006-09-20 03:42:06 +0000
+++ linux-2.6.18-194.8.1.el5.028stab070.2.owl1/scripts/mkcompile_h	2009-03-01 05:35:12 +0000
@@ -47,17 +47,9 @@ UTS_TRUNCATE="sed -e s/\(.\{1,$UTS_LEN\}
   echo \#define UTS_VERSION \"`echo $UTS_VERSION | $UTS_TRUNCATE`\"
 
   echo \#define LINUX_COMPILE_TIME \"`LC_ALL=C LANG=C date +%T`\"
-  echo \#define LINUX_COMPILE_BY \"`whoami`\"
-  echo \#define LINUX_COMPILE_HOST \"`hostname | $UTS_TRUNCATE`\"
-
-  if [ -x /bin/dnsdomainname ]; then
-    echo \#define LINUX_COMPILE_DOMAIN \"`dnsdomainname | $UTS_TRUNCATE`\"
-  elif [ -x /bin/domainname ]; then
-    echo \#define LINUX_COMPILE_DOMAIN \"`domainname | $UTS_TRUNCATE`\"
-  else
-    echo \#define LINUX_COMPILE_DOMAIN
-  fi
-
+  echo \#define LINUX_COMPILE_BY \"sources\"
+  echo \#define LINUX_COMPILE_HOST \"${ARCH}.example.org\"
+  echo \#define LINUX_COMPILE_DOMAIN \"\"
   echo \#define LINUX_COMPILER \"`$CC -v 2>&1 | tail -n 1`\"
 ) > .tmpcompile
 
