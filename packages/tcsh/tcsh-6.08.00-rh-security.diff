--- tcsh-6.08.00/sh.dir.c.security	Sat Sep 26 08:28:29 1998
+++ tcsh-6.08.00/sh.dir.c	Wed Feb 24 22:16:14 1999
@@ -35,6 +35,7 @@
  * SUCH DAMAGE.
  */
 #include "sh.h"
+#include "tw.h"
 
 RCSID("$Id: sh.dir.c,v 3.51 1998/09/26 12:28:29 christos Exp $")
 
@@ -1268,7 +1269,9 @@
 		return (0);
 	}
     }
-    (void) Strcpy(s, dp->di_name);
+
+    (void) Strncpy(s, dp->di_name, FILSIZ);    
+    s[FILSIZ-1]=0;
     return (1);
 }
 
