CVE-2009-1892: server may terminate when receiving certain well-formed
DHCP requests, provided that the server configuration mixes host
definitions using "dhcp-client-identifier" and "hardware ethernet".

Discovery and patch by Christoph Biedl.

--- dhcp/server/dhcp.c
+++ dhcp/server/dhcp.c
@@ -1800,6 +1800,8 @@ void ack_lease (packet, lease, offer, when, msg, ms_nulltp, hp)
 				host_reference (&host, h, MDL);
 		}
 		if (!host) {
+			if (hp)
+				host_dereference (&hp, MDL);
 			find_hosts_by_haddr (&hp,
 					     packet -> raw -> htype,
 					     packet -> raw -> chaddr,
