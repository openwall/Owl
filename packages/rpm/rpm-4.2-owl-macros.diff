diff -ur rpm-4.2.orig/macros.in rpm-4.2/macros.in
--- rpm-4.2.orig/macros.in	Wed Mar  5 00:13:11 2003
+++ rpm-4.2/macros.in	Fri Apr  1 23:04:07 2005
@@ -164,11 +164,11 @@
 #	The directory where newly built source packages will be written.
 %_srcrpmdir		%{_topdir}/SRPMS
 
-#	Directory where temporaray files can be created.
+#	Directory where temporary files can be created.
 %_tmppath		%{_var}/tmp
 
 #	Path to top of build area.
-%_topdir		%{_usrsrc}/redhat
+%_topdir		%{_usrsrc}/.rpm.d
 
 #	The path to the unzip executable (legacy, use %{__unzip} instead).
 %_unzipbin		%{__unzip}
@@ -272,8 +272,8 @@
 #		"w9.gzdio"	gzip level 9 (default).
 #		"w9.bzdio"	bzip2 level 9.
 #
-#%_source_payload	w9.gzdio
-#%_binary_payload	w9.gzdio
+%_source_payload	w9.bzdio
+%_binary_payload	w9.bzdio
 
 #	The signature to use and the location of configuration files for
 #	signing packages with PGP.
@@ -311,17 +311,17 @@
 # Should unpackaged files in a build root terminate a build?
 #
 # Note: The default value should be 0 for legacy compatibility.
-%_unpackaged_files_terminate_build	1
+%_unpackaged_files_terminate_build	0
 
 #
 # Should missing %doc files in the build directory terminate a build?
 #
 # Note: The default value should be 0 for legacy compatibility.
-%_missing_doc_files_terminate_build	1
+%_missing_doc_files_terminate_build	0
 
 #
 # Use internal dependency generator rather than external helpers?
-%_use_internal_dependency_generator	1
+%_use_internal_dependency_generator	0
 
 #
 # Path to scripts to autogenerate package dependencies,
@@ -449,7 +449,7 @@
 
 # Use a CDB database model for concurrent access.
 # XXX Add "private" here for legacy interoperation transiting to glibc+nptl.
-%__dbi_cdb			create cdb mpool mp_mmapsize=16Mb mp_size=1Mb
+%__dbi_cdb			cdb mpool mp_mmapsize=16Mb mp_size=1Mb
 
 %__dbi_other			%{?_tmppath:tmpdir=%{_tmppath}} %{?__dbi_cdb}
 
@@ -698,14 +698,14 @@
 #	Note: These values are specific to my machine, and most certainly
 #	are incorrect for any non-redhat.com machine. The macros are
 #	included here only to document the macro names and usage.
-%_bhpath        file://localhost/mnt/dist
-%_bhcoll        @(7.3|7.2|7.1|7.1sbe|7.1k|7.0|7.01j|7.0j|7.0sbe|7.0tc|6.2|6.2ha|6.2ee|6.1|6.0|5.2|5.1|5.0)
-%_bhN           @(SRPMS|i386|alpha|sparc|s390|ia64)
-%_bhVR          RedHat
-%_bhA           RPMS
+#%_bhpath        file://localhost/mnt/dist
+#%_bhcoll        @(7.3|7.2|7.1|7.1sbe|7.1k|7.0|7.01j|7.0j|7.0sbe|7.0tc|6.2|6.2ha|6.2ee|6.1|6.0|5.2|5.1|5.0)
+#%_bhN           @(SRPMS|i386|alpha|sparc|s390|ia64)
+#%_bhVR          RedHat
+#%_bhA           RPMS
 
 #	The cache database directory.
-%_cache_dbpath		/var/spool/up2date/cache
+#%_cache_dbpath		/var/spool/up2date/cache
 
 #==============================================================================
 # ---- per-platform macros.
@@ -753,6 +753,96 @@
   export RPM_BUILD_ROOT}\
   %{?_javaclasspath:CLASSPATH=\"%{_javaclasspath}\"\
   export CLASSPATH}\
+  # These autoconf variables are predefined to harden configure checks for\
+  # security sensitive functions, and to speedup configure checks for\
+  # most popular functions.\
+  export ac_cv_func_alloca=yes\
+  export ac_cv_func_asprintf=yes\
+  export ac_cv_func_atexit=yes\
+  export ac_cv_func_bcopy=yes\
+  export ac_cv_func_dcgettext=yes\
+  export ac_cv_func_fchdir=yes\
+  export ac_cv_func_fchmod=yes\
+  export ac_cv_func_fchown=yes\
+  export ac_cv_func_fork=yes\
+  export ac_cv_func_fseeko=yes\
+  export ac_cv_func_ftruncate=yes\
+  export ac_cv_func_fwprintf=yes\
+  export ac_cv_func_getaddrinfo=yes\
+  export ac_cv_func_getcwd=yes\
+  export ac_cv_func_getegid=yes\
+  export ac_cv_func_geteuid=yes\
+  export ac_cv_func_getgid=yes\
+  export ac_cv_func_gethostname=yes\
+  export ac_cv_func_getline=yes\
+  export ac_cv_func_getopt=yes\
+  export ac_cv_func_getpagesize=yes\
+  export ac_cv_func_getrusage=yes\
+  export ac_cv_func_gettimeofday=yes\
+  export ac_cv_func_getuid=yes\
+  export ac_cv_func_iconv=yes\
+  export ac_cv_func_isascii=yes\
+  export ac_cv_func_iswcntrl=yes\
+  export ac_cv_func_lstat=yes\
+  export ac_cv_func_mbrtowc=yes\
+  export ac_cv_func_mbsinit=yes\
+  export ac_cv_func_memchr=yes\
+  export ac_cv_func_memcmp=yes\
+  export ac_cv_func_memcpy=yes\
+  export ac_cv_func_memmove=yes\
+  export ac_cv_func_mempcpy=yes\
+  export ac_cv_func_memset=yes\
+  export ac_cv_func_mkstemp=yes\
+  export ac_cv_func_mmap=yes\
+  export ac_cv_func_munmap=yes\
+  export ac_cv_func_pathconf=yes\
+  export ac_cv_func_putenv=yes\
+  export ac_cv_func_raise=yes\
+  export ac_cv_func_readlink=yes\
+  export ac_cv_func_realpath=yes\
+  export ac_cv_func_rename=yes\
+  export ac_cv_func_sbrk=yes\
+  export ac_cv_func_select=yes\
+  export ac_cv_func_setenv=yes\
+  export ac_cv_func_setlocale=yes\
+  export ac_cv_func_sigaction=yes\
+  export ac_cv_func_sigprocmask=yes\
+  export ac_cv_func_sigsetmask=yes\
+  export ac_cv_func_snprintf=yes\
+  export ac_cv_func_stpcpy=yes\
+  export ac_cv_func_strcasecmp=yes\
+  export ac_cv_func_strchr=yes\
+  export ac_cv_func_strdup=yes\
+  export ac_cv_func_strerror=yes\
+  export ac_cv_func_strftime=yes\
+  export ac_cv_func_strlcat=yes\
+  export ac_cv_func_strlcpy=yes\
+  export ac_cv_func_strncasecmp=yes\
+  export ac_cv_func_strncat=yes\
+  export ac_cv_func_strncmp=yes\
+  export ac_cv_func_strncpy=yes\
+  export ac_cv_func_strndup=yes\
+  export ac_cv_func_strnlen=yes\
+  export ac_cv_func_strstr=yes\
+  export ac_cv_func_strtol=yes\
+  export ac_cv_func_strtoul=yes\
+  export ac_cv_func_strtoull=yes\
+  export ac_cv_func_sysconf=yes\
+  export ac_cv_func_tcgetattr=yes\
+  export ac_cv_func_times=yes\
+  export ac_cv_func_tmpfile=yes\
+  export ac_cv_func_tsearch=yes\
+  export ac_cv_func_uname=yes\
+  export ac_cv_func_unsetenv=yes\
+  export ac_cv_func_utime=yes\
+  export ac_cv_func_utimes=yes\
+  export ac_cv_func_vasprintf=yes\
+  export ac_cv_func_vfork=yes\
+  export ac_cv_func_vprintf=yes\
+  export ac_cv_func_vsnprintf=yes\
+  export ac_cv_func_waitpid=yes\
+  export ac_cv_func_wcslen=yes\
+  export ac_cv_func_wcwidth=yes\
   \
   %{verbose:set -x}%{!verbose:exec > /dev/null}\
   umask 022\
@@ -903,15 +993,15 @@
 %_sbindir		%{_exec_prefix}/sbin
 %_libexecdir		%{_exec_prefix}/libexec
 %_datadir		%{_prefix}/share
-%_sysconfdir		%{_prefix}/etc
+%_sysconfdir		/etc
 %_sharedstatedir	%{_prefix}/com
 %_localstatedir		%{_prefix}/var
 %_lib			lib
 %_libdir		%{_exec_prefix}/%{_lib}
 %_includedir		%{_prefix}/include
 %_oldincludedir		/usr/include
-%_infodir		%{_prefix}/info
-%_mandir		%{_prefix}/man
+%_infodir		%{_prefix}/share/info
+%_mandir		%{_prefix}/share/man
 
 #==============================================================================
 # ---- config.guess platform macros.
