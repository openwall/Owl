diff -urp glibc-2.3.6.orig/malloc/malloc.c glibc-2.3.6/malloc/malloc.c
--- glibc-2.3.6.orig/malloc/malloc.c	2005-07-18 02:46:03 +0000
+++ glibc-2.3.6/malloc/malloc.c	2017-10-25 17:33:06 +0000
@@ -3513,6 +3513,13 @@ public_mEMALIGn(size_t alignment, size_t
   /* Otherwise, ensure that it is at least a minimum chunk size */
   if (alignment <  MINSIZE) alignment = MINSIZE;
 
+  /* Check for overflow.  */
+  if (bytes > SIZE_MAX - alignment - MINSIZE)
+    {
+      __set_errno (ENOMEM);
+      return 0;
+    }
+
   arena_get(ar_ptr, bytes + alignment + MINSIZE);
   if(!ar_ptr)
     return 0;
@@ -3552,6 +3559,13 @@ public_vALLOc(size_t bytes)
   if(__malloc_initialized < 0)
     ptmalloc_init ();
 
+  /* Check for overflow.  */
+  if (bytes > SIZE_MAX - mp_.pagesize - MINSIZE)
+    {
+      __set_errno (ENOMEM);
+      return 0;
+    }
+
   __malloc_ptr_t (*hook) __MALLOC_PMT ((size_t, size_t,
 					__const __malloc_ptr_t)) =
     __memalign_hook;
@@ -3575,6 +3589,13 @@ public_pVALLOc(size_t bytes)
   if(__malloc_initialized < 0)
     ptmalloc_init ();
 
+  /* Check for overflow.  */
+  if (bytes > SIZE_MAX - 2*mp_.pagesize - MINSIZE)
+    {
+      __set_errno (ENOMEM);
+      return 0;
+    }
+
   __malloc_ptr_t (*hook) __MALLOC_PMT ((size_t, size_t,
 					__const __malloc_ptr_t)) =
     __memalign_hook;
