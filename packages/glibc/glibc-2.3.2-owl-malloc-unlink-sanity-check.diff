diff -uNrp glibc-2.3.2.orig/malloc/malloc.c glibc-2.3.2/malloc/malloc.c
--- glibc-2.3.2.orig/malloc/malloc.c	2004-03-09 10:22:33 +0000
+++ glibc-2.3.2/malloc/malloc.c	2004-03-09 10:44:26 +0000
@@ -311,6 +311,11 @@ extern "C" {
 #define assert(x) ((void)0)
 #endif
 
+#include <abort-instr.h>
+#ifndef ABORT_INSTRUCTION
+#define ABORT_INSTRUCTION
+#endif
+
 
 /*
   INTERNAL_SIZE_T is the word-size used for internal bookkeeping
@@ -1951,6 +1956,13 @@ typedef struct malloc_chunk* mbinptr;
 #define unlink(P, BK, FD) {                                            \
   FD = P->fd;                                                          \
   BK = P->bk;                                                          \
+  if (FD->bk != P || BK->fd != P)                                      \
+  {                                                                    \
+    ABORT_INSTRUCTION;                                                 \
+    _exit(127);                                                        \
+    while (1)                                                          \
+      ABORT_INSTRUCTION;                                               \
+  }                                                                    \
   FD->bk = BK;                                                         \
   BK->fd = FD;                                                         \
 }
