diff -uNrp glibc-2.3.2.orig/resolv/res_send.c glibc-2.3.2/resolv/res_send.c
--- glibc-2.3.2.orig/resolv/res_send.c	2002-10-17 21:45:42 +0000
+++ glibc-2.3.2/resolv/res_send.c	2004-03-09 10:32:05 +0000
@@ -832,7 +832,9 @@ send_vc(res_state statp,
 		}
 	} else
 		len = resplen;
-	if (len < HFIXEDSZ) {
+	if (len < HFIXEDSZ ||
+	    (resplen < HFIXEDSZ + QFIXEDSZ &&
+	    anssiz >= HFIXEDSZ + QFIXEDSZ)) {
 		/*
 		 * Undersized message.
 		 */
@@ -1060,7 +1062,9 @@ send_dg(res_state statp,
 		return (0);
 	}
 	*gotsomewhere = 1;
-	if (resplen < HFIXEDSZ) {
+	if (resplen < HFIXEDSZ ||
+	    (resplen < HFIXEDSZ + QFIXEDSZ &&
+	    anssiz >= HFIXEDSZ + QFIXEDSZ)) {
 		/*
 		 * Undersized message.
 		 */
