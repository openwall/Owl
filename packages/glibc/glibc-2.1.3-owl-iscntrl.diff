--- glibc-2.1.3/locale/programs/ld-ctype.c.orig	Thu Feb 24 22:19:02 2000
+++ glibc-2.1.3/locale/programs/ld-ctype.c	Sat Apr  7 22:12:26 2001
@@ -128,6 +128,7 @@
 			    const char *name, struct charset_t *charset);
 static u_int32_t *find_idx (struct locale_ctype_t *ctype, u_int32_t **table,
 			    size_t *max, size_t *act, unsigned int idx);
+static void force_controls (struct locale_ctype_t *ctype);
 static void set_class_defaults (struct locale_ctype_t *ctype,
 				struct charset_t *charset,
 				struct repertoire_t *repertoire);
@@ -237,6 +238,9 @@
   unsigned int space_value;
   struct locale_ctype_t *ctype = locale->categories[LC_CTYPE].ctype;
 
+  /* Force the known control characters.  */
+  force_controls (ctype);
+
   /* Set default value for classes not specified.  */
   set_class_defaults (ctype, charset, locale->repertoire);
 
@@ -1081,6 +1085,31 @@
 
 
 static void
+force_controls (struct locale_ctype_t *ctype)
+{
+  void set_cntrl (int from, int to)
+    {
+      int ch;
+
+      for (ch = from; ch <= to; ++ch)
+	{
+	  ctype->class_collection256[ch] &= BIT (tok_space) | BIT (tok_blank);
+	  ctype->class_collection256[ch] |= BIT (tok_cntrl);
+
+	  ELEM (ctype, class_collection, , ch) &=
+	    BIT (tok_space) | BIT (tok_blank);
+	  ELEM (ctype, class_collection, , ch) |= BIT (tok_cntrl);
+	}
+    }
+
+  /* Force the known control characters.  */
+  set_cntrl (0000, 0037);
+  set_cntrl (0177, 0177);
+  set_cntrl (0200, 0237);
+}
+
+
+static void
 set_class_defaults (struct locale_ctype_t *ctype, struct charset_t *charset,
 		    struct repertoire_t *repertoire)
 {
@@ -1120,7 +1149,7 @@
 
   /* Set default values if keyword was not present.  */
   if ((ctype->class_done & BIT (tok_upper)) == 0)
-    /* "If this keyword [lower] is not specified, the lowercase letters
+    /* "If this keyword [upper] is not specified, the uppercase letters
         `A' through `Z', ..., shall automatically belong to this class,
 	with implementation defined character values."  [P1003.2, 2.5.2.1]  */
     set_default (BIT (tok_upper), 'A', 'Z');
--- glibc-2.1.3/locale/C-ctype.c.orig	Fri Feb 25 01:48:02 2000
+++ glibc-2.1.3/locale/C-ctype.c	Sat Apr  7 21:50:29 2001
@@ -29,12 +29,12 @@
    is set to always return 0 and the conversion arrays return EOF.  */
 
 const char _nl_C_LC_CTYPE_class[768] =
-  /* 0x80 */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
-  /* 0x86 */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
-  /* 0x8c */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
-  /* 0x92 */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
-  /* 0x98 */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
-  /* 0x9e */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
+  /* 0x80 */ "\002\000" "\002\000" "\002\000" "\002\000" "\002\000" "\002\000"
+  /* 0x86 */ "\002\000" "\002\000" "\002\000" "\002\000" "\002\000" "\002\000"
+  /* 0x8c */ "\002\000" "\002\000" "\002\000" "\002\000" "\002\000" "\002\000"
+  /* 0x92 */ "\002\000" "\002\000" "\002\000" "\002\000" "\002\000" "\002\000"
+  /* 0x98 */ "\002\000" "\002\000" "\002\000" "\002\000" "\002\000" "\002\000"
+  /* 0x9e */ "\002\000" "\002\000" "\000\000" "\000\000" "\000\000" "\000\000"
   /* 0xa4 */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
   /* 0xaa */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
   /* 0xb0 */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
@@ -71,12 +71,12 @@
   /* 0x6a */ "\010\306" "\010\306" "\010\306" "\010\306" "\010\306" "\010\306"
   /* 0x70 */ "\010\306" "\010\306" "\010\306" "\010\306" "\010\306" "\010\306"
   /* 0x76 */ "\010\306" "\010\306" "\010\306" "\010\306" "\010\306" "\004\300"
-  /* 0x7c */ "\004\300" "\004\300" "\004\300" "\002\000" "\000\000" "\000\000"
-  /* 0x82 */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
-  /* 0x88 */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
-  /* 0x8e */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
-  /* 0x94 */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
-  /* 0x9a */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
+  /* 0x7c */ "\004\300" "\004\300" "\004\300" "\002\000" "\002\000" "\002\000"
+  /* 0x82 */ "\002\000" "\002\000" "\002\000" "\002\000" "\002\000" "\002\000"
+  /* 0x88 */ "\002\000" "\002\000" "\002\000" "\002\000" "\002\000" "\002\000"
+  /* 0x8e */ "\002\000" "\002\000" "\002\000" "\002\000" "\002\000" "\002\000"
+  /* 0x94 */ "\002\000" "\002\000" "\002\000" "\002\000" "\002\000" "\002\000"
+  /* 0x9a */ "\002\000" "\002\000" "\002\000" "\002\000" "\002\000" "\002\000"
   /* 0xa0 */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
   /* 0xa6 */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
   /* 0xac */ "\000\000" "\000\000" "\000\000" "\000\000" "\000\000" "\000\000"
@@ -137,18 +137,18 @@
   /* 0x75 */ "\000\000\010\306" "\000\000\010\306" "\000\000\010\306"
   /* 0x78 */ "\000\000\010\306" "\000\000\010\306" "\000\000\010\306"
   /* 0x7b */ "\000\000\004\300" "\000\000\004\300" "\000\000\004\300"
-  /* 0x7e */ "\000\000\004\300" "\000\000\002\000" "\000\000\000\000"
-  /* 0x81 */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
-  /* 0x84 */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
-  /* 0x87 */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
-  /* 0x8a */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
-  /* 0x8d */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
-  /* 0x90 */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
-  /* 0x93 */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
-  /* 0x96 */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
-  /* 0x99 */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
-  /* 0x9c */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
-  /* 0x9f */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
+  /* 0x7e */ "\000\000\004\300" "\000\000\002\000" "\000\000\002\000"
+  /* 0x81 */ "\000\000\002\000" "\000\000\002\000" "\000\000\002\000"
+  /* 0x84 */ "\000\000\002\000" "\000\000\002\000" "\000\000\002\000"
+  /* 0x87 */ "\000\000\002\000" "\000\000\002\000" "\000\000\002\000"
+  /* 0x8a */ "\000\000\002\000" "\000\000\002\000" "\000\000\002\000"
+  /* 0x8d */ "\000\000\002\000" "\000\000\002\000" "\000\000\002\000"
+  /* 0x90 */ "\000\000\002\000" "\000\000\002\000" "\000\000\002\000"
+  /* 0x93 */ "\000\000\002\000" "\000\000\002\000" "\000\000\002\000"
+  /* 0x96 */ "\000\000\002\000" "\000\000\002\000" "\000\000\002\000"
+  /* 0x99 */ "\000\000\002\000" "\000\000\002\000" "\000\000\002\000"
+  /* 0x9c */ "\000\000\002\000" "\000\000\002\000" "\000\000\002\000"
+  /* 0x9f */ "\000\000\002\000" "\000\000\000\000" "\000\000\000\000"
   /* 0xa2 */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
   /* 0xa5 */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
   /* 0xa8 */ "\000\000\000\000" "\000\000\000\000" "\000\000\000\000"
