--- Makefile.am
+++ Makefile.am
@@ -14,9 +14,15 @@ endif
 lib_LTLIBRARIES =
 
 # libiptc
-lib_LTLIBRARIES           += libiptc/libip4tc.la libiptc/libip6tc.la libiptc/libiptc.la
+lib_LTLIBRARIES           += libiptc/libip4tc.la
+if ENABLE_IPV6
+lib_LTLIBRARIES           += libiptc/libip6tc.la
+endif
 libiptc_libiptc_la_SOURCES  =
-libiptc_libiptc_la_LIBADD   = libiptc/libip4tc.la libiptc/libip6tc.la
+libiptc_libiptc_la_LIBADD   = libiptc/libip4tc.la
+if ENABLE_IPV6
+libiptc_libiptc_la_LIBADD  += libiptc/libip6tc.la
+endif
 libiptc_libiptc_la_LDFLAGS  = -version-info 0:0:0
 libiptc_libip4tc_la_SOURCES = libiptc/libip4tc.c
 libiptc_libip4tc_la_LDFLAGS = -version-info 0:0:0
@@ -54,8 +60,10 @@ ip6tables_multi_LDADD     = libiptc/libip6tc.la extensions/libext6.a libxtables.
 
 sbin_PROGRAMS    =
 man_MANS         = iptables.8 iptables-restore.8 iptables-save.8 \
-                   iptables-xml.8 ip6tables.8 ip6tables-restore.8 \
-                   ip6tables-save.8
+                   iptables-xml.8
+if ENABLE_IPV6
+man_MANS        += ip6tables.8 ip6tables-restore.8 ip6tables-save.8
+endif
 CLEANFILES       = iptables.8 ip6tables.8
 
 if ENABLE_IPV4
--- extensions/GNUmakefile.in
+++ extensions/GNUmakefile.in
@@ -85,7 +85,7 @@ init%.o: init%.c
 #	Shared libraries
 #
 lib%.so: lib%.oo
-	${AM_VERBOSE_CCLD} ${CCLD} ${AM_LDFLAGS} -shared ${LDFLAGS} -o $@ $< -lm -L../.libs -lxtables -L../libiptc/.libs -lip4tc -lip6tc;
+	${AM_VERBOSE_CCLD} ${CCLD} ${AM_LDFLAGS} -shared ${LDFLAGS} -o $@ $< -lm -L../.libs -lxtables -L../libiptc/.libs -lip4tc @ENABLE_IPV6_TRUE@ -lip6tc
 
 lib%.oo: ${srcdir}/lib%.c
 	${AM_VERBOSE_CC} ${CC} ${AM_DEPFLAGS} ${AM_CFLAGS} -D_INIT=lib$*_init -DPIC -fPIC ${CFLAGS} -o $@ -c $<;
