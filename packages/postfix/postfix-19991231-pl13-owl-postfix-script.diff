diff -ur postfix-19991231-pl13-snapshot-20011217-safe-opens/conf/postfix-script-sgid postfix-19991231-pl13/conf/postfix-script-sgid
--- postfix-19991231-pl13-snapshot-20011217-safe-opens/conf/postfix-script-sgid	Sat Dec 22 23:38:27 2001
+++ postfix-19991231-pl13/conf/postfix-script-sgid	Wed Dec 26 16:47:14 2001
@@ -177,36 +177,39 @@
 
 	test -d maildrop || {
 		$WARN creating missing Postfix maildrop directory
-		mkdir maildrop || exit 1
-		chmod 1730 maildrop
-		chown $mail_owner maildrop
-		chgrp maildrop maildrop
+		mkdir -m 700 maildrop || exit
 	}
+	chmod 700 maildrop || exit
+	chown ${mail_owner}.postdrop maildrop || exit
+	chmod 1730 maildrop || exit
 	test -d pid || {
 		$WARN creating missing Postfix pid directory
-		mkdir pid || exit 1
-		chmod 755 pid
+		mkdir -m 700 pid || exit
 	}
+	chmod 700 pid || exit
+	chown root. pid || exit
 	for dir in incoming active bounce defer deferred saved corrupt; do
 		test -d $dir || {
 			$WARN creating missing Postfix $dir directory
-			mkdir $dir || exit 1
-			chmod 700 $dir; $CHATTR $dir
-			chown $mail_owner $dir
+			mkdir -m 700 $dir || exit
+			$CHATTR $dir
 		}
+		chmod 700 $dir || exit
+		chown ${mail_owner}. $dir || exit
 	done
 	test -d public || {
 		$WARN creating missing Postfix public directory
-		mkdir public || exit 1
-		chmod 755 public
-		chown $mail_owner public
+		mkdir -m 700 public || exit
 	}
+	chmod 700 public || exit
+	chown ${mail_owner}. public || exit
+	chmod 755 public || exit
 	test -d private || {
 		$WARN creating missing Postfix private directory
-		mkdir private || exit 1
-		chmod 700 private
-		chown $mail_owner private
+		mkdir -m 700 private || exit
 	}
+	chmod 700 private || exit
+	chown ${mail_owner}. private || exit
 	find `ls -d $queue_directory/* | \
 	    egrep '/(incoming|active|defer|deferred|bounce|saved|corrupt|public|private)$'` \
 	    ! \( -type p -o -type s \) ! -user $mail_owner \
@@ -225,6 +228,18 @@
 			cmp -s $path /$path || 
 			    $WARN $queue_directory/$path and /$path differ
 		done
+	done
+
+	# Update the chroot jail
+	mkdir -m 755 -p ${queue_directory}/{etc,lib}
+	for src in /etc/{localtime,resolv.conf,host.conf,hosts,services} \
+	    /lib/libnss_dns{-2.*.so,.so.2}; do
+		test -e "$src" || continue
+		dst="${queue_directory}${src}"
+		cmp -s "$src" "$dst" && continue
+		$WARN "updating $dst"
+		cp -a "$src" "${dst}.tmp"
+		mv -f "${dst}.tmp" "$dst"
 	done
 
 	$command_directory/postsuper || exit 1
