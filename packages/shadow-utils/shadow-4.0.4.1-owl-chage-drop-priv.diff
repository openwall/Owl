diff -uNrp shadow-4.0.4.1/src/chage.c shadow-4.0.4.1.owl-chage-drop-priv/src/chage.c
--- shadow-4.0.4.1/src/chage.c	2003-06-19 17:57:15 +0000
+++ shadow-4.0.4.1.owl-chage-drop-priv/src/chage.c	2004-02-28 23:03:34 +0000
@@ -352,6 +352,7 @@ int main (int argc, char **argv)
 	const struct spwd *sp;
 	struct spwd spwd;
 	uid_t ruid;
+	gid_t rgid;
 	int amroot, pwrw;
 	const struct passwd *pw;
 	struct passwd pwent;
@@ -369,6 +370,7 @@ int main (int argc, char **argv)
 	textdomain (PACKAGE);
 
 	ruid = getuid ();
+	rgid = getgid ();
 	amroot = (ruid == 0);
 
 	/*
@@ -548,7 +550,7 @@ int main (int argc, char **argv)
 		exit (1);
 	}
 
-	if (lflg && (setgid (getgid ()) || setuid (ruid))) {
+	if (lflg && (setregid (rgid, rgid) || setreuid (ruid, ruid))) {
 		fprintf (stderr, "%s: failed to drop privileges (%s)\n",
 			 Prog, strerror (errno));
 		exit (1);
