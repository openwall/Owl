CVE-2007-2438
--- vim64.orig/src/eval.c
+++ vim64/src/eval.c
@@ -7203,6 +7203,9 @@ f_system(argvars, retvar)
 {
     char_u	*p;
 
+    if (check_restricted() || check_secure())
+	return;
+
     p = get_cmd_output(get_var_string(&argvars[0]), SHELL_SILENT);
 #ifdef USE_CR
     /* translate <CR> into <NL> */
