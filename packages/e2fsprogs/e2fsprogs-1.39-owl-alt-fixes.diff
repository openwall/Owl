diff -upk.orig e2fsprogs-1.39.orig/config/parse-types.sh e2fsprogs-1.39/config/parse-types.sh
--- e2fsprogs-1.39.orig/config/parse-types.sh	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/config/parse-types.sh	2006-06-06 00:11:04 +0000
@@ -22,6 +22,8 @@ gcc -E $ASM_TYPES | sed -f /tmp/sed.scri
 cp asm_types.h asm_types.c
 
 cat >> asm_types.c <<EOF
+#include <stdio.h>
+#include <stdlib.h>
 main(int argc, char **argv)
 {
 #ifdef __U8_TYPEDEF
diff -upk.orig e2fsprogs-1.39.orig/debugfs/set_fields.c e2fsprogs-1.39/debugfs/set_fields.c
--- e2fsprogs-1.39.orig/debugfs/set_fields.c	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/debugfs/set_fields.c	2006-06-06 01:21:58 +0000
@@ -10,6 +10,7 @@
  */
 
 #define _XOPEN_SOURCE 500 /* for inclusion of strptime() */
+#define _BSD_SOURCE /* for inclusion of strcasecmp() */
 
 #include <stdio.h>
 #include <unistd.h>
diff -upk.orig e2fsprogs-1.39.orig/debugfs/util.c e2fsprogs-1.39/debugfs/util.c
--- e2fsprogs-1.39.orig/debugfs/util.c	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/debugfs/util.c	2006-06-06 01:21:58 +0000
@@ -6,6 +6,12 @@
  *
  */
 
+#ifdef HAVE_STRPTIME
+# ifndef _XOPEN_SOURCE
+#  define _XOPEN_SOURCE 500 /* for inclusion of strptime() */
+# endif
+#endif
+
 #include <stdio.h>
 #include <unistd.h>
 #include <stdlib.h>
diff -upk.orig e2fsprogs-1.39.orig/e2fsck/e2fsck.h e2fsprogs-1.39/e2fsck/e2fsck.h
--- e2fsprogs-1.39.orig/e2fsck/e2fsck.h	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/e2fsck/e2fsck.h	2006-06-06 01:21:58 +0000
@@ -464,6 +464,9 @@ extern void e2fsck_read_inode(e2fsck_t c
 			      struct ext2_inode * inode, const char * proc);
 extern void e2fsck_write_inode(e2fsck_t ctx, unsigned long ino,
 			       struct ext2_inode * inode, const char * proc);
+extern void e2fsck_write_inode_full(e2fsck_t ctx, unsigned long ino,
+			       struct ext2_inode * inode, int bufsize,
+			       const char *proc);
 #ifdef MTRACE
 extern void mtrace_print(char *mesg);
 #endif
diff -upk.orig e2fsprogs-1.39.orig/e2fsck/journal.c e2fsprogs-1.39/e2fsck/journal.c
--- e2fsprogs-1.39.orig/e2fsck/journal.c	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/e2fsck/journal.c	2006-06-06 00:40:47 +0000
@@ -971,8 +971,6 @@ int e2fsck_fix_ext3_journal_hint(e2fsck_
 	struct problem_context pctx;
 	char uuid[37], *journal_name;
 	struct stat st;
-	problem_t problem;
-	int retval;
 
 	if (!(sb->s_feature_compat & EXT3_FEATURE_COMPAT_HAS_JOURNAL) ||
 	    uuid_is_null(sb->s_journal_uuid))
diff -upk.orig e2fsprogs-1.39.orig/e2fsck/pass1.c e2fsprogs-1.39/e2fsck/pass1.c
--- e2fsprogs-1.39.orig/e2fsck/pass1.c	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/e2fsck/pass1.c	2006-06-06 01:21:58 +0000
@@ -246,7 +246,7 @@ static void check_ea_in_inode(e2fsck_t c
 	struct ext2_super_block *sb = ctx->fs->super;
 	struct ext2_inode_large *inode;
 	struct ext2_ext_attr_entry *entry;
-	char *start, *end, *name;
+	char *start, *end;
 	int storage_size, remain, offs;
 	int problem = 0;
 
@@ -327,7 +327,7 @@ fix:
 
 	/* simple remove all possible EA(s) */
 	*((__u32 *)start) = 0UL;
-	e2fsck_write_inode_full(ctx, pctx->ino, inode,
+	e2fsck_write_inode_full(ctx, pctx->ino, pctx->inode,
 				EXT2_INODE_SIZE(sb), "pass1");
 }
 
@@ -864,7 +864,6 @@ void e2fsck_pass1(e2fsck_t ctx)
 
 	if (ctx->flags & E2F_FLAG_RESIZE_INODE) {
 		ext2fs_block_bitmap save_bmap;
-		errcode_t retval;
 
 		save_bmap = fs->block_map;
 		fs->block_map = ctx->block_found_map;
diff -upk.orig e2fsprogs-1.39.orig/lib/blkid/dev.c e2fsprogs-1.39/lib/blkid/dev.c
--- e2fsprogs-1.39.orig/lib/blkid/dev.c	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/lib/blkid/dev.c	2006-06-06 01:21:58 +0000
@@ -193,10 +193,10 @@ extern char *optarg;
 extern int optind;
 #endif
 
-void usage(char *prog)
+static void usage(char *prog)
 {
 	fprintf(stderr, "Usage: %s [-f blkid_file] [-m debug_mask]\n", prog);
-	fprintf(stderr, "\tList all devices and exit\n", prog);
+	fprintf(stderr, "\tList all devices and exit\n");
 	exit(1);
 }
 
@@ -219,7 +219,7 @@ int main(int argc, char **argv)
 		case 'm':
 			blkid_debug_mask = strtoul (optarg, &tmp, 0);
 			if (*tmp) {
-				fprintf(stderr, "Invalid debug mask: %d\n", 
+				fprintf(stderr, "Invalid debug mask: %s\n", 
 					optarg);
 				exit(1);
 			}
diff -upk.orig e2fsprogs-1.39.orig/lib/blkid/probe.c e2fsprogs-1.39/lib/blkid/probe.c
--- e2fsprogs-1.39.orig/lib/blkid/probe.c	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/lib/blkid/probe.c	2006-06-06 00:35:13 +0000
@@ -153,7 +153,6 @@ static int probe_ext3(struct blkid_probe
 		      unsigned char *buf)
 {
 	struct ext2_super_block *es;
-	char uuid[37];
 	es = (struct ext2_super_block *)buf;
 
 	/* Distinguish between jbd and ext2/3 fs */
diff -upk.orig e2fsprogs-1.39.orig/lib/blkid/tag.c e2fsprogs-1.39/lib/blkid/tag.c
--- e2fsprogs-1.39.orig/lib/blkid/tag.c	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/lib/blkid/tag.c	2006-06-06 01:21:58 +0000
@@ -381,12 +381,12 @@ extern char *optarg;
 extern int optind;
 #endif
 
-void usage(char *prog)
+static void usage(char *prog)
 {
 	fprintf(stderr, "Usage: %s [-f blkid_file] [-m debug_mask] device "
 		"[type value]\n", 
 		prog);
-	fprintf(stderr, "\tList all tags for a device and exit\n", prog);
+	fprintf(stderr, "\tList all tags for a device and exit\n");
 	exit(1);
 }
 
@@ -412,7 +412,7 @@ int main(int argc, char **argv)
 		case 'm':
 			blkid_debug_mask = strtoul (optarg, &tmp, 0);
 			if (*tmp) {
-				fprintf(stderr, "Invalid debug mask: %d\n", 
+				fprintf(stderr, "Invalid debug mask: %s\n", 
 					optarg);
 				exit(1);
 			}
diff -upk.orig e2fsprogs-1.39.orig/lib/blkid/tst_types.c e2fsprogs-1.39/lib/blkid/tst_types.c
--- e2fsprogs-1.39.orig/lib/blkid/tst_types.c	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/lib/blkid/tst_types.c	2006-06-06 01:23:33 +0000
@@ -9,9 +9,11 @@
  * %End-Header%
  */
 
+#include <stdio.h>
+#include <stdlib.h>
 #include "blkid/blkid_types.h"
 
-main(int argc, char **argv)
+int main(int argc, char **argv)
 {
 	if (sizeof(__u8) != 1) {
 		printf("Sizeof(__u8) is %d should be 1\n", 
diff -upk.orig e2fsprogs-1.39.orig/lib/ext2fs/tst_bitops.c e2fsprogs-1.39/lib/ext2fs/tst_bitops.c
--- e2fsprogs-1.39.orig/lib/ext2fs/tst_bitops.c	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/lib/ext2fs/tst_bitops.c	2006-06-06 01:36:03 +0000
@@ -38,7 +38,7 @@ int bits_list[] = {
 #define BIG_TEST_BIT   (((unsigned) 1 << 31) + 42)
 
 
-main(int argc, char **argv)
+int main(int argc, char **argv)
 {
 	int	i, j, size;
 	unsigned char testarray[12];
@@ -117,7 +117,7 @@ main(int argc, char **argv)
 	ext2fs_clear_bit(BIG_TEST_BIT, bigarray);
 	
 	printf("big bit number (%u) test: %d, expected 0\n", BIG_TEST_BIT,
-	       bigarray[BIG_TEST_BIT >> 3], 0);
+	       bigarray[BIG_TEST_BIT >> 3]);
 	if (bigarray[BIG_TEST_BIT >> 3] != 0)
 		exit(1);
 
@@ -163,7 +163,7 @@ main(int argc, char **argv)
 	ext2fs_fast_clear_bit(BIG_TEST_BIT, bigarray);
 	
 	printf("big bit number (%u) test: %d, expected 0\n", BIG_TEST_BIT,
-	       bigarray[BIG_TEST_BIT >> 3], 0);
+	       bigarray[BIG_TEST_BIT >> 3]);
 	if (bigarray[BIG_TEST_BIT >> 3] != 0)
 		exit(1);
 
diff -upk.orig e2fsprogs-1.39.orig/lib/ext2fs/tst_types.c e2fsprogs-1.39/lib/ext2fs/tst_types.c
--- e2fsprogs-1.39.orig/lib/ext2fs/tst_types.c	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/lib/ext2fs/tst_types.c	2006-06-06 01:23:43 +0000
@@ -9,9 +9,11 @@
  * %End-Header%
  */
 
+#include <stdio.h>
+#include <stdlib.h>
 #include "ext2fs/ext2_types.h"
 
-main(int argc, char **argv)
+int main(int argc, char **argv)
 {
 	if (sizeof(__u8) != 1) {
 		printf("Sizeof(__u8) is %d should be 1\n", 
diff -upk.orig e2fsprogs-1.39.orig/misc/dumpe2fs.c e2fsprogs-1.39/misc/dumpe2fs.c
--- e2fsprogs-1.39.orig/misc/dumpe2fs.c	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/misc/dumpe2fs.c	2006-06-06 01:34:20 +0000
@@ -310,7 +310,7 @@ static void print_journal_information(ex
 		 "Journal first block:      %u\n"
 		 "Journal sequence:         0x%08x\n"
 		 "Journal start:            %u\n"
-		 "Journal number of users:  %lu\n"),
+		 "Journal number of users:  %u\n"),
 	       ntohl(jsb->s_blocksize),  ntohl(jsb->s_maxlen),
 	       ntohl(jsb->s_first), ntohl(jsb->s_sequence),
 	       ntohl(jsb->s_start), ntohl(jsb->s_nr_users));
diff -upk.orig e2fsprogs-1.39.orig/resize/sim_progress.c e2fsprogs-1.39/resize/sim_progress.c
--- e2fsprogs-1.39.orig/resize/sim_progress.c	2006-05-29 21:24:59 +0000
+++ e2fsprogs-1.39/resize/sim_progress.c	2006-06-06 01:32:20 +0000
@@ -80,6 +80,7 @@ errcode_t ext2fs_progress_init(ext2_sim_
 			       __u32 maxdone, int flags)
 {
 	ext2_sim_progmeter	prog;
+	void			*void_label;
 	errcode_t		retval;
 
 	retval = ext2fs_get_mem(sizeof(struct ext2_sim_progress), &prog);
@@ -87,11 +88,12 @@ errcode_t ext2fs_progress_init(ext2_sim_
 		return retval;
 	memset(prog, 0, sizeof(struct ext2_sim_progress));
 
-	retval = ext2fs_get_mem(strlen(label)+1, (void **) &prog->label);
+	retval = ext2fs_get_mem(strlen(label)+1, &void_label);
 	if (retval) {
 		free(prog);
 		return retval;
 	}
+	prog->label = void_label;
 	strcpy(prog->label, label);
 	prog->labelwidth = labelwidth;
 	prog->barwidth = barwidth;
