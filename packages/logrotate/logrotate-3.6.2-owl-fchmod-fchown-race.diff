--- logrotate-3.6.2/logrotate.c.orig	Tue Jan 29 22:27:17 2002
+++ logrotate-3.6.2/logrotate.c	Mon Mar 11 19:39:20 2002
@@ -125,7 +125,7 @@
 	    close(fdcurr);
 	    return 1;
 	}
-	if (fchmod(fdsave, sb->st_mode)) {
+	if (fchmod(fdsave, (S_IRUSR | S_IWUSR) & sb->st_mode)) {
 	    message(MESS_ERROR, "error setting mode of %s: %s\n",
 		saveLog, strerror(errno));
 	    close(fdcurr);
@@ -139,6 +139,13 @@
 	    close(fdsave);
 	    return 1;
 	}
+	if (fchmod(fdsave, sb->st_mode)) {
+	    message(MESS_ERROR, "error setting mode of %s: %s\n",
+		saveLog, strerror(errno));
+	    close(fdcurr);
+	    close(fdsave);
+	    return 1;
+	}
 	while ((cnt = read(fdcurr, buf, sizeof(buf))) > 0) {
 	    if (write(fdsave, buf, cnt) != cnt) {
 		message(MESS_ERROR, "error writing to %s: %s\n", 
@@ -445,7 +452,7 @@
                             log->files[logNum], strerror(errno));
                     hasErrors = 1;
                 } else {
-                    if (fchmod(fd, createMode)) {
+                    if (fchmod(fd, (S_IRUSR | S_IWUSR) & createMode)) {
                         message(MESS_ERROR, "error setting mode of "
                                 "%s: %s\n", log->files[logNum], 
 				strerror(errno));
@@ -457,7 +464,13 @@
 				strerror(errno));
                         hasErrors = 1;
 		    }
-		    
+	            if (fchmod(fd, createMode)) {
+                        message(MESS_ERROR, "error setting mode of "
+                                "%s: %s\n", log->files[logNum], 
+				strerror(errno));
+                        hasErrors = 1;
+                    }
+
                     close(fd);
 		}
 	    }
