Tavis Ormandy and Will Drewry of the Google Security Team discovered a
possible DoS in the sslv2 client code.  Where a client application uses
OpenSSL to make a SSLv2 connection to a malicious server that server
could cause the client to crash.  CVE-2006-4343

--- openssl-0.9.7g.orig/ssl/s2_clnt.c
+++ openssl-0.9.7g/ssl/s2_clnt.c
@@ -538,7 +538,8 @@ static int get_server_hello(SSL *s)
 		CRYPTO_add(&s->session->peer->references, 1, CRYPTO_LOCK_X509);
 		}
 
-	if (s->session->peer != s->session->sess_cert->peer_key->x509)
+	if (s->session->sess_cert == NULL ||
+	    s->session->peer != s->session->sess_cert->peer_key->x509)
 		/* can't happen */
 		{
 		ssl2_return_error(s, SSL2_PE_UNDEFINED_ERROR);
