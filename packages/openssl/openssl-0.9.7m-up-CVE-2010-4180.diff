diff -uNp -r openssl-0.9.7m.orig/ssl/s3_clnt.c openssl-0.9.7m/ssl/s3_clnt.c
--- openssl-0.9.7m.orig/ssl/s3_clnt.c	2011-02-25 16:30:50 +0000
+++ openssl-0.9.7m/ssl/s3_clnt.c	2011-02-25 16:32:23 +0000
@@ -707,8 +707,11 @@ static int ssl3_get_server_hello(SSL *s)
 		s->session->cipher_id = s->session->cipher->id;
 	if (s->hit && (s->session->cipher_id != c->id))
 		{
+/* Workaround is now obsolete */
+#if 0
 		if (!(s->options &
 			SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG))
+#endif
 			{
 			al=SSL_AD_ILLEGAL_PARAMETER;
 			SSLerr(SSL_F_SSL3_GET_SERVER_HELLO,SSL_R_OLD_SESSION_CIPHER_NOT_RETURNED);
diff -uNp -r openssl-0.9.7m.orig/ssl/s3_srvr.c openssl-0.9.7m/ssl/s3_srvr.c
--- openssl-0.9.7m.orig/ssl/s3_srvr.c	2011-02-25 16:30:50 +0000
+++ openssl-0.9.7m/ssl/s3_srvr.c	2011-02-25 16:38:39 +0000
@@ -777,6 +777,10 @@ static int ssl3_get_client_hello(SSL *s)
 			}
 		if (j == 0)
 			{
+/* Disabled because it can be used in a ciphersuite downgrade
+ * attack: CVE-2010-4180.
+ */
+#if 0
 			if ((s->options & SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG) && (sk_SSL_CIPHER_num(ciphers) == 1))
 				{
 				/* Very bad for multi-threading.... */
@@ -784,6 +788,7 @@ static int ssl3_get_client_hello(SSL *s)
 								       0);
 				}
 			else
+#endif
 				{
 				/* we need to have the cipher in the cipher
 				 * list if we are asked to reuse it */
