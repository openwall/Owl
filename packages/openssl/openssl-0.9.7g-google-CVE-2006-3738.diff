Tavis Ormandy and Will Drewry of the Google Security Team discovered a
buffer overflow in SSL_get_shared_ciphers utility function, used by some
applications such as exim and mysql.  An attacker could send a list of
ciphers that would overrun a buffer.  CVE-2006-3738

--- openssl-0.9.7g.orig/ssl/ssl_lib.c
+++ openssl-0.9.7g/ssl/ssl_lib.c
@@ -1167,7 +1167,7 @@ char *SSL_get_shared_ciphers(const SSL *
 		c=sk_SSL_CIPHER_value(sk,i);
 		for (cp=c->name; *cp; )
 			{
-			if (len-- == 0)
+			if (len-- <= 0)
 				{
 				*p='\0';
 				return(buf);
