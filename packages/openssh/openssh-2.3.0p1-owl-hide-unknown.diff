diff -ur openssh-2.3.0p1.orig/auth1.c openssh-2.3.0p1/auth1.c
--- openssh-2.3.0p1.orig/auth1.c	Sat Oct 14 09:23:11 2000
+++ openssh-2.3.0p1/auth1.c	Mon Nov 20 07:49:07 2000
@@ -349,11 +349,10 @@
 		    type == SSH_CMSG_AUTH_PASSWORD)
 			authlog = log;
 
-		authlog("%s %s for %s%.100s from %.200s port %d%s",
+		authlog("%s %s for %.100s from %.200s port %d%s",
 			authenticated ? "Accepted" : "Failed",
 			get_authname(type),
-			pw ? "" : "illegal user ",
-			pw && pw->pw_uid == 0 ? "ROOT" : luser,
+			pw ? (pw->pw_uid ? luser : "ROOT") : "an unknown user",
 			get_remote_ipaddr(),
 			get_remote_port(),
 			user);
@@ -403,8 +402,6 @@
 	/* Get the user name. */
 	user = packet_get_string(&ulen);
 	packet_integrity_check(plen, (4 + ulen), SSH_CMSG_USER);
-
-	setproctitle("%s", user);
 
 #ifdef AFS
 	/* If machine has AFS, set process authentication group. */
diff -ur openssh-2.3.0p1.orig/auth2.c openssh-2.3.0p1/auth2.c
--- openssh-2.3.0p1.orig/auth2.c	Sat Oct 28 14:05:57 2000
+++ openssh-2.3.0p1/auth2.c	Mon Nov 20 07:40:55 2000
@@ -208,8 +208,9 @@
 	if (authctxt->attempt == 1) { 
 		/* setup auth context */
 		struct passwd *pw = NULL;
-		setproctitle("%s", user);
 		pw = getpwnam(user);
+		if (pw)
+			setproctitle("%s", user);
 		if (pw && allowed_user(pw) && strcmp(service, "ssh-connection")==0) {
 			authctxt->pw = pwcopy(pw);
 			authctxt->valid = 1;
