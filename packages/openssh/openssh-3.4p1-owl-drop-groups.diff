diff -ur openssh-3.4p1.orig/sshd.c openssh-3.4p1/sshd.c
--- openssh-3.4p1.orig/sshd.c	Wed Jun 26 03:24:19 2002
+++ openssh-3.4p1/sshd.c	Sat Jun 29 21:17:31 2002
@@ -1051,8 +1051,15 @@
 	 * to create a file, and we can't control the code in every 
 	 * module which might be used).
 	 */
-	if (setgroups(0, NULL) < 0)
-		debug("setgroups() failed: %.200s", strerror(errno));
+	if (geteuid() == 0 && setgroups(0, NULL) != 0)
+#ifndef USE_PAM
+	/*
+	 * We can ignore the lack of support for having no supplementary
+	 * groups at all if don't use PAM.
+	 */
+		if (errno != EINVAL)
+#endif
+			fatal("setgroups: %.200s", strerror(errno));
 
 	/* Initialize the log (it is reinitialized below in case we forked). */
 	if (debug_flag && !inetd_flag)
