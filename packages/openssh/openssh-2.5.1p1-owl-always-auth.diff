diff -ur openssh-2.5.1p1-owl-hide-unknown/auth-pam.c openssh-2.5.1p1-owl-always-auth/auth-pam.c
--- openssh-2.5.1p1-owl-hide-unknown/auth-pam.c	Thu Feb 15 03:51:32 2001
+++ openssh-2.5.1p1-owl-always-auth/auth-pam.c	Wed Feb 28 10:37:33 2001
@@ -201,14 +201,19 @@
 {
 	extern ServerOptions options;
 	int pam_retval;
+	int fail;
 
 	do_pam_set_conv(&conv);
 
 	/* deny if no user. */
-	if (pw == NULL)
-		return 0;
-	if (pw->pw_uid == 0 && options.permit_root_login == 2)
-		return 0;
+	fail = 0;
+	if (pw == NULL ||
+	    (pw->pw_uid == 0 && options.permit_root_login == 2)) {
+		/* Attempt to reduce information leaks via timings. */
+		fail = 1;
+		password = "INCORRECT";
+	}
+
 	if (*password == '\0' && options.permit_empty_passwd == 0)
 		return 0;
 
@@ -216,14 +221,14 @@
 
 	pamstate = INITIAL_LOGIN;
 	pam_retval = do_pam_authenticate(0);
-	if (pam_retval == PAM_SUCCESS) {
-		debug("PAM Password authentication accepted for "
-		    "user \"%.100s\"", pw->pw_name);
+	if (!fail && pam_retval == PAM_SUCCESS) {
+		debug("PAM password authentication accepted for "
+		    "%.100s", pw->pw_name);
 		return 1;
 	} else {
-		debug("PAM Password authentication for \"%.100s\" "
-		    "failed[%d]: %s", pw->pw_name, pam_retval, 
-		    PAM_STRERROR(__pamh, pam_retval));
+		debug("PAM password authentication failed for "
+		    "%.100s: %s", pw ? pw->pw_name : "an illegal user",
+		    fail ? "Forced" : PAM_STRERROR(__pamh, pam_retval));
 		return 0;
 	}
 }
diff -ur openssh-2.5.1p1-owl-hide-unknown/auth1.c openssh-2.5.1p1-owl-always-auth/auth1.c
--- openssh-2.5.1p1-owl-hide-unknown/auth1.c	Wed Feb 28 08:34:17 2001
+++ openssh-2.5.1p1-owl-always-auth/auth1.c	Wed Feb 28 10:15:41 2001
@@ -401,6 +401,8 @@
 #ifdef USE_PAM
 	if (pw)
 		start_pam(user);
+	else
+		start_pam("ILLEGAL USER");
 #endif
 
 	/*
diff -ur openssh-2.5.1p1-owl-hide-unknown/auth2.c openssh-2.5.1p1-owl-always-auth/auth2.c
--- openssh-2.5.1p1-owl-hide-unknown/auth2.c	Wed Feb 28 08:34:17 2001
+++ openssh-2.5.1p1-owl-always-auth/auth2.c	Wed Feb 28 10:15:41 2001
@@ -203,7 +203,7 @@
 			authctxt->valid = 0;
 			log("input_userauth_request: illegal user %s", user);
 #ifdef USE_PAM
-			start_pam("NOUSER");
+			start_pam("ILLEGAL USER");
 #endif
 		}
 		setproctitle("%s", authctxt->known ? user : "unknown user");
