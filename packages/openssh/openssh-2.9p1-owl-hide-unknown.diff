diff -ur openssh-2.9p1.orig/auth.c openssh-2.9p1-owl-hide-unknown/auth.c
--- openssh-2.9p1.orig/auth.c	Tue Mar 20 01:15:57 2001
+++ openssh-2.9p1-owl-hide-unknown/auth.c	Sun May  6 22:47:49 2001
@@ -191,8 +191,10 @@
 	authlog("%s %s for %s%.100s from %.200s port %d%s",
 	    authmsg,
 	    method,
-	    authctxt->valid ? "" : "illegal user ",
-	    authctxt->valid && authctxt->pw->pw_uid == 0 ? "ROOT" : authctxt->user,
+	    !authctxt->known ? "an unknown user" :
+	    (!authctxt->valid ? "illegal user " :
+	    (authctxt->pw->pw_uid == 0 ? "ROOT user " : "")),
+	    authctxt->known ? authctxt->user : "",
 	    get_remote_ipaddr(),
 	    get_remote_port(),
 	    info);
diff -ur openssh-2.9p1.orig/auth.h openssh-2.9p1-owl-hide-unknown/auth.h
--- openssh-2.9p1.orig/auth.h	Fri Apr 13 03:34:35 2001
+++ openssh-2.9p1-owl-hide-unknown/auth.h	Sun May  6 22:47:49 2001
@@ -40,6 +40,7 @@
 	int success;
 	int postponed;
 	int valid;
+	int known;
 	int attempt;
 	int failures;
 	char *user;
diff -ur openssh-2.9p1.orig/auth1.c openssh-2.9p1-owl-hide-unknown/auth1.c
--- openssh-2.9p1.orig/auth1.c	Sat Mar 24 03:37:59 2001
+++ openssh-2.9p1-owl-hide-unknown/auth1.c	Sun May  6 22:47:49 2001
@@ -386,6 +386,7 @@
 
 	/* Verify that the user is a valid user. */
 	pw = getpwnam(user);
+	authctxt->known = (pw != NULL);
 	if (pw && allowed_user(pw)) {
 		authctxt->valid = 1;
 		pw = pwcopy(pw);
@@ -395,7 +396,7 @@
 	}
 	authctxt->pw = pw;
 
-	setproctitle("%s", pw ? user : "unknown");
+	setproctitle("%s", authctxt->known ? user : "unknown user");
 
 #ifdef USE_PAM
 	if (pw)
diff -ur openssh-2.9p1.orig/auth2.c openssh-2.9p1-owl-hide-unknown/auth2.c
--- openssh-2.9p1.orig/auth2.c	Wed Apr 25 16:44:15 2001
+++ openssh-2.9p1-owl-hide-unknown/auth2.c	Mon May  7 03:11:53 2001
@@ -203,6 +203,7 @@
 		/* setup auth context */
 		struct passwd *pw = NULL;
 		pw = getpwnam(user);
+		authctxt->known = (pw != NULL);
 		if (pw && allowed_user(pw) && strcmp(service, "ssh-connection")==0) {
 			authctxt->pw = pwcopy(pw);
 			authctxt->valid = 1;
@@ -211,12 +212,13 @@
 			start_pam(pw->pw_name);
 #endif
 		} else {
-			log("input_userauth_request: illegal user %s", user);
+			authctxt->pw = NULL;
+			authctxt->valid = 0;
 #ifdef USE_PAM
 			start_pam("NOUSER");
 #endif
 		}
-		setproctitle("%s", pw ? user : "unknown");
+		setproctitle("%s", authctxt->known ? user : "unknown user");
 		authctxt->user = xstrdup(user);
 		authctxt->service = xstrdup(service);
 		authctxt->style = style ? xstrdup(style) : NULL; /* currently unused */
