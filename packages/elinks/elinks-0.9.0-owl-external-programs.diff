diff -ur elinks-0.9.0.orig/src/setup.h elinks-0.9.0/src/setup.h
--- elinks-0.9.0.orig/src/setup.h	Mon Dec  8 00:39:59 2003
+++ elinks-0.9.0/src/setup.h	Sun Jan 25 14:33:30 2004
@@ -96,9 +96,9 @@
 /* Default external programs for protocol.user.* autocreated options */
 #define DEFAULT_AC_OPT_MAILTO		"mutt %h -s \"%s\""
 #define DEFAULT_AC_OPT_TELNET		"telnet %h %p"
-#define DEFAULT_AC_OPT_TN3270		"tn3270 %h %p"
-#define DEFAULT_AC_OPT_GOPHER		"lynx %u"
-#define DEFAULT_AC_OPT_NEWS		"lynx %u"
-#define DEFAULT_AC_OPT_IRC		"irc %u"
+#define DEFAULT_AC_OPT_TN3270		""
+#define DEFAULT_AC_OPT_GOPHER		""
+#define DEFAULT_AC_OPT_NEWS		""
+#define DEFAULT_AC_OPT_IRC		""
 
 #endif
diff -ur elinks-0.9.0.orig/src/terminal/terminal.c elinks-0.9.0/src/terminal/terminal.c
--- elinks-0.9.0.orig/src/terminal/terminal.c	Thu Nov 27 14:05:22 2003
+++ elinks-0.9.0/src/terminal/terminal.c	Sun Jan 25 14:49:55 2004
@@ -232,6 +232,7 @@
 #if defined(HAVE_SETPGID) && !defined(BEOS) && !defined(HAVE_BEGINTHREAD)
 	if (path[0] == 2) setpgid(0, 0);
 #endif
+	/* XXX: This interface should be re-arranged to use execvp(3). */
 	exe(path + 1);
 	close(p);
 	if (path[plen]) unlink(path + plen);
diff -ur elinks-0.9.0.orig/src/util/conv.c elinks-0.9.0/src/util/conv.c
--- elinks-0.9.0.orig/src/util/conv.c	Tue Oct 28 01:42:22 2003
+++ elinks-0.9.0/src/util/conv.c	Sun Jan 25 14:17:04 2004
@@ -293,10 +293,16 @@
 struct string *
 add_shell_safe_to_string(struct string *string, unsigned char *cmd, int cmdlen)
 {
+	int prev_safe = 0;
+
 	for (; cmdlen; cmdlen--, cmd++) {
-		if (is_safe_in_shell(*cmd)) {
+		if ((*cmd == '-' && prev_safe) ||
+		    (prev_safe = is_safe_in_shell(*cmd))) {
 			add_char_to_string(string, *cmd);
 		} else {
+			/* XXX: Not all programs we might exec are capable of
+			 * decoding these.  For some, we should just report
+			 * an error rather than exec with an encoded string. */
 			add_char_to_string(string, '%');
 			add_char_to_string(string, hx((*cmd & 0xf0) >> 4));
 			add_char_to_string(string, hx(*cmd & 0x0f));
diff -ur elinks-0.9.0.orig/src/util/conv.h elinks-0.9.0/src/util/conv.h
--- elinks-0.9.0.orig/src/util/conv.h	Mon Dec  1 13:56:41 2003
+++ elinks-0.9.0/src/util/conv.h	Sun Jan 25 14:10:14 2004
@@ -16,7 +16,13 @@
 static inline int
 is_safe_in_shell(unsigned char c)
 {
-	return c == '@' || c == '+' || c == '.' || c == '/' || c == ':' || isA(c);
+	/* Note: '-' is often used to indicate a command-line option and thus
+	 * is not always safe. */
+	return c == '@' || c == '+' || c == '.' || c == '/' || c == ':'
+		|| c == '_'
+		|| (c >= 'A' && c <= 'Z')
+		|| (c >= 'a' && c <= 'z')
+		|| (c >= '0' && c <= '9');
 }
 
 
