Index: ChangeLog
===================================================================
RCS file: /cvsroot/strace/strace/ChangeLog,v
retrieving revision 1.402
retrieving revision 1.403
diff -u -p -a -r1.402 -r1.403
--- ChangeLog	3 Aug 2005 12:18:37 -0000	1.402
+++ ChangeLog	21 Oct 2005 22:06:58 -0000	1.403
@@ -1,3 +1,7 @@
+2005-10-21  Roland McGrath  <roland@redhat.com>
+
+	* util.c (printpathn): Cap N at sizeof path - 1.
+
 2005-08-03  Roland McGrath  <roland@redhat.com>
 
 	* configure.ac, NEWS: Version 4.5.13.
Index: util.c
===================================================================
RCS file: /cvsroot/strace/strace/util.c,v
retrieving revision 1.63
retrieving revision 1.64
diff -u -p -a -r1.63 -r1.64
--- util.c	4 Jul 2005 23:28:11 -0000	1.63
+++ util.c	21 Oct 2005 22:06:46 -0000	1.64
@@ -30,7 +30,7 @@
  * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
  * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  *
- *	$Id: util.c,v 1.63 2005/07/04 23:28:11 roland Exp $
+ *	$Id: util.c,v 1.64 2005/10/21 22:06:46 roland Exp $
  */
 
 #include "defs.h"
@@ -424,6 +424,9 @@ struct tcb *tcp;
 long addr;
 int n;
 {
+	if (n >= sizeof path)
+		n = sizeof path - 1;
+
 	if (addr == 0)
 		tprintf("NULL");
 	else 	if (umovestr(tcp, addr, n, path) < 0)
