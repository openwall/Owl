diff -uNp -r patch-2.5.9.orig/pch.c patch-2.5.9/pch.c
--- patch-2.5.9.orig/pch.c	2011-02-09 18:18:35 +0000
+++ patch-2.5.9/pch.c	2011-02-09 18:32:10 +0000
@@ -35,6 +35,14 @@
 
 #define INITHUNKMAX 125			/* initial dynamic allocation size */
 
+#ifndef DIRECTORY_SEPARATOR
+# define DIRECTORY_SEPARATOR '/'
+#endif
+#ifndef ISSLASH
+# define ISSLASH(C) ((C) == DIRECTORY_SEPARATOR)
+#endif
+#define IS_ABSOLUTE_FILE_NAME(F) (ISSLASH ((F)[0]))
+
 /* Patch (diff listing) abstract type. */
 
 static FILE *pfp;			/* patch file pointer */
@@ -195,6 +203,24 @@ grow_hunkmax (void)
     return false;
 }
 
+static void
+validate_target_name (char const *n)
+{
+  char const *p = n;
+  if (IS_ABSOLUTE_FILE_NAME (p))
+    fatal ("rejecting absolute target file name: %s", quotearg (p));
+  while (*p)
+    {
+      if (*p == '.' && *++p == '.' && ( ! *++p || ISSLASH (*p)))
+       fatal ("rejecting target file name with \"..\" component: %s",
+              quotearg (n));
+      while (*p && ! ISSLASH (*p))
+       p++;
+      while (ISSLASH (*p))
+       p++;
+    }
+}
+
 /* True if the remainder of the patch file contains a diff of some sort. */
 
 bool
@@ -612,6 +638,8 @@ intuit_diff_type (void)
 	    if ((! is_empty) < p_says_nonexistent[reverse ^ is_empty])
 	      {
 		assert (i0 != NONE);
+		validate_target_name (name[i == NONE || st[i].st_size == 0 ? i0 : i]);
+
 		reverse ^=
 		  ok_to_reverse
 		    ("The next patch%s would %s the file %s,\nwhich %s!",
@@ -658,6 +686,7 @@ intuit_diff_type (void)
 	inerrno = stat_errno[i];
 	invc = version_controlled[i];
 	instat = st[i];
+	validate_target_name (inname);
       }
 
     for (i = OLD;  i <= INDEX;  i++)
