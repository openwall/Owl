diff -uNp -r patch-2.5.9.orig/ChangeLog patch-2.5.9/ChangeLog
--- patch-2.5.9.orig/ChangeLog	2011-02-02 13:56:38 +0000
+++ patch-2.5.9/ChangeLog	2011-02-02 13:59:42 +0000
@@ -1,3 +1,13 @@
+2011-02-01  Jim Meyering  <meyering@redhat.com>
+
+	do not let a malicious patch create files above current directory
+	This addresses CVE-2010-4651, reported by Jakub Wilk.
+	https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2010-4651
+	* src/pch.c (intuit_diff_type): Reject any file name containing a
+	component of "..".
+	* tests/dot-dot: New file.  Test for this.
+	* tests/Makefile.am (TESTS): Add it.
+
 2003-05-20  Paul Eggert  <eggert@twinsun.com>
 
 	* NEWS, configure.ac (AC_INIT): Version 2.5.9 released.
@@ -2271,7 +2281,7 @@ Sun Dec 17 17:29:48 1989  Jim Kingdon  (
 Copyright (C) 1984, 1985, 1986, 1987, 1988 Larry Wall.
 
 Copyright (C) 1989, 1990, 1991, 1992, 1993, 1997, 1998, 1999, 2000, 2001,
-2002 Free Software Foundation, Inc.
+2002, 2011 Free Software Foundation, Inc.
 
 This file is part of GNU Patch.
 
diff -uNp -r patch-2.5.9.orig/pch.c patch-2.5.9/pch.c
--- patch-2.5.9.orig/pch.c	2011-02-02 13:56:38 +0000
+++ patch-2.5.9/pch.c	2011-02-02 14:04:24 +0000
@@ -5,7 +5,7 @@
 /* Copyright (C) 1986, 1987, 1988 Larry Wall
 
    Copyright (C) 1990, 1991, 1992, 1993, 1997, 1998, 1999, 2000, 2001,
-   2002, 2003 Free Software Foundation, Inc.
+   2002, 2003, 2011 Free Software Foundation, Inc.
 
    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
@@ -664,6 +664,20 @@ intuit_diff_type (void)
       if (name[i])
 	free (name[i]);
 
+    if (inname)
+      {
+	/* If inname starts with "../" ends with "/.." or contains
+	   "/../", then issue a fatal error.  */
+	size_t len = strlen (inname);
+	if (len >= 3
+	    && (strnEQ (inname, "../", 3)
+		|| strnEQ (inname + len - 3, "/..", 3)
+		|| strstr (inname, "/../")))
+	  fatal ("rejecting file name with \"..\" component: %s",
+		 quotearg (inname));
+      }
+
+
     return retval;
 }
 
