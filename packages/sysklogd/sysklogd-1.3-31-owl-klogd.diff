diff -ur sysklogd-1.3-31.orig/klogd.c sysklogd-1.3-31/klogd.c
--- sysklogd-1.3-31.orig/klogd.c	Tue Jan 19 03:09:12 1999
+++ sysklogd-1.3-31/klogd.c	Thu Sep 14 10:34:17 2000
@@ -539,6 +539,7 @@
 
 {
 	va_list ap;
+	char *arg1;
 
 	if ( debugging )
 	{
@@ -561,36 +562,46 @@
 	}
 	
 	/* Output using syslog. */
-	if ( *fmt == '<' )
+	if (!strcmp(fmt, "%s"))
 	{
-		switch ( *(fmt+1) )
-		{
-		    case '0':
-			priority = LOG_EMERG;
-			break;
-		    case '1':
-			priority = LOG_ALERT;
-			break;
-		    case '2':
-			priority = LOG_CRIT;
-			break;
-		    case '3':
-			priority = LOG_ERR;
-			break;
-		    case '4':
-			priority = LOG_WARNING;
-			break;
-		    case '5':
-			priority = LOG_NOTICE;
-			break;
-		    case '6':
-			priority = LOG_INFO;
-			break;
-		    case '7':
-		    default:
-			priority = LOG_DEBUG;
+		va_start(ap, fmt);
+		arg1 = va_arg(ap, char *);
+		if (arg1[0] == '<' && arg1[1] && arg1[2] == '>') {
+			switch (arg1[1])
+			{
+			    case '0':
+				priority = LOG_EMERG;
+				break;
+			    case '1':
+				priority = LOG_ALERT;
+				break;
+			    case '2':
+				priority = LOG_CRIT;
+				break;
+			    case '3':
+				priority = LOG_ERR;
+				break;
+			    case '4':
+				priority = LOG_WARNING;
+				break;
+			    case '5':
+				priority = LOG_NOTICE;
+				break;
+			    case '6':
+				priority = LOG_INFO;
+				break;
+			    case '7':
+			    default:
+				priority = LOG_DEBUG;
+			}
+			arg1 += 3;
 		}
-		fmt += 3;
+		syslog(priority, fmt, arg1);
+		va_end(ap);
+#ifdef TESTING
+		putchar('\n');
+#endif
+		return;
 	}
 	
 	va_start(ap, fmt);
@@ -673,7 +684,7 @@
 		fprintf(stderr, "\tLine: %s\n", line);
 	    }
 
-            Syslog( LOG_INFO, line_buff );
+            Syslog( LOG_INFO, "%s", line_buff );
             line  = line_buff;
             space = sizeof(line_buff)-1;
             parse_state = PARSING_TEXT;
@@ -700,7 +711,7 @@
                   len   -= 1;
 
                   *line = 0;  /* force null terminator */
-	          Syslog( LOG_INFO, line_buff );
+	          Syslog( LOG_INFO, "%s", line_buff );
                   line  = line_buff;
                   space = sizeof(line_buff)-1;
                   break;
