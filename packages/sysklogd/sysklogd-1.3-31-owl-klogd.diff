diff -ur sysklogd-1.3-31.orig/klogd.c sysklogd-1.3-31/klogd.c
--- sysklogd-1.3-31.orig/klogd.c	Tue Jan 19 03:09:12 1999
+++ sysklogd-1.3-31/klogd.c	Thu Sep 14 10:17:16 2000
@@ -535,7 +535,7 @@
 }
 
 
-extern void Syslog(int priority, char *fmt, ...)
+extern void Syslog(int priority, char *fmt, char *arg1, ...)
 
 {
 	va_list ap;
@@ -561,9 +561,9 @@
 	}
 	
 	/* Output using syslog. */
-	if ( *fmt == '<' )
+	if (!strcmp(fmt, "%s") && arg1[0] == '<' && arg1[1] && arg1[2] == '>')
 	{
-		switch ( *(fmt+1) )
+		switch (arg1[1])
 		{
 		    case '0':
 			priority = LOG_EMERG;
@@ -590,7 +590,11 @@
 		    default:
 			priority = LOG_DEBUG;
 		}
-		fmt += 3;
+		syslog(priority, fmt, arg1 + 3);
+#ifdef TESTING
+		putchar('\n');
+#endif
+		return;
 	}
 	
 	va_start(ap, fmt);
@@ -673,7 +677,7 @@
 		fprintf(stderr, "\tLine: %s\n", line);
 	    }
 
-            Syslog( LOG_INFO, line_buff );
+            Syslog( LOG_INFO, "%s", line_buff );
             line  = line_buff;
             space = sizeof(line_buff)-1;
             parse_state = PARSING_TEXT;
@@ -700,7 +704,7 @@
                   len   -= 1;
 
                   *line = 0;  /* force null terminator */
-	          Syslog( LOG_INFO, line_buff );
+	          Syslog( LOG_INFO, "%s", line_buff );
                   line  = line_buff;
                   space = sizeof(line_buff)-1;
                   break;
